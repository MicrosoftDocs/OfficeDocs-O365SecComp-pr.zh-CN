---
title: 批量编辑内容搜索
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: 12/29/2016
audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid: MOE150
ms.assetid: 39e4654a-9588-41f6-892b-c33ab57bfbe2
description: 使用 Office 365 或 Microsoft 365 中的安全与合规中心中的批量搜索编辑器快速更改一个或多个内容搜索的查询和内容位置。
ms.openlocfilehash: 69d2a40a28fd435873eae9b19ad2c8ad1e25d27c
ms.sourcegitcommit: b262d40f6daf06be26e7586f37b736e09f8a4511
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 07/02/2019
ms.locfileid: "35435112"
---
# <a name="bulk-edit-content-searches"></a><span data-ttu-id="3e91c-103">批量编辑内容搜索</span><span class="sxs-lookup"><span data-stu-id="3e91c-103">Bulk edit Content Searches</span></span>

<span data-ttu-id="3e91c-104">您可以使用内容搜索工具中的批量搜索编辑器同时编辑多个搜索。</span><span class="sxs-lookup"><span data-stu-id="3e91c-104">You can use the Bulk Search Editor in the Content Search tool to edit multiple searches at the same time.</span></span> <span data-ttu-id="3e91c-105">使用此工具可以快速更改一个或多个搜索的查询和内容位置。</span><span class="sxs-lookup"><span data-stu-id="3e91c-105">Using this tool lets you quickly change the query and content locations for one or more searches.</span></span> <span data-ttu-id="3e91c-106">然后, 您可以重新运行搜索并为修订后的搜索获取新的估计搜索结果。</span><span class="sxs-lookup"><span data-stu-id="3e91c-106">Then you can re-run the searches and get new estimated search results for the revised searches.</span></span> <span data-ttu-id="3e91c-107">编辑器还允许您从 Microsoft Excel 文件或文本文件中复制并粘贴查询和内容位置。</span><span class="sxs-lookup"><span data-stu-id="3e91c-107">The editor also lets you copy and paste queries and content locations from a Microsoft Excel file or text file.</span></span> <span data-ttu-id="3e91c-108">这意味着您可以使用搜索统计信息工具查看一个或多个搜索的统计信息, 将统计信息导出到 CSV 文件, 您可以在其中编辑 Excel 中的查询和内容位置。</span><span class="sxs-lookup"><span data-stu-id="3e91c-108">This means you can use the Search Statistics tool to view the statistics of one or more searches, export the statistics to a CSV file where you can edit the queries and content locations in Excel.</span></span> <span data-ttu-id="3e91c-109">然后, 使用批量搜索编辑器将修订后的查询和内容位置添加到搜索中。</span><span class="sxs-lookup"><span data-stu-id="3e91c-109">Then you use the Bulk Search Editor to add the revised queries and content locations to the searches.</span></span> <span data-ttu-id="3e91c-110">在您修订了一个或多个搜索之后, 可以重新启动它们并获取新的估计搜索结果。</span><span class="sxs-lookup"><span data-stu-id="3e91c-110">After you've revised one or more searches, you can re-start them and get new estimated search results.</span></span>
  
<span data-ttu-id="3e91c-111">有关使用搜索统计信息工具的详细信息, 请参阅[查看内容搜索结果的关键字统计](view-keyword-statistics-for-content-search.md)信息。</span><span class="sxs-lookup"><span data-stu-id="3e91c-111">For more information about using the Search Statistics tool, see [View keyword statistics for Content Search results](view-keyword-statistics-for-content-search.md).</span></span>
  
## <a name="use-the-bulk-search-editor-to-change-queries"></a><span data-ttu-id="3e91c-112">使用批量搜索编辑器更改查询</span><span class="sxs-lookup"><span data-stu-id="3e91c-112">Use the Bulk Search Editor to change queries</span></span>

1. <span data-ttu-id="3e91c-113">转到[https://protection.office.com](https://protection.office.com), 然后单击 "**搜索** \> **内容搜索**"。</span><span class="sxs-lookup"><span data-stu-id="3e91c-113">Go to [https://protection.office.com](https://protection.office.com), and then click **Search** \> **Content search**.</span></span>
    
2. <span data-ttu-id="3e91c-114">在搜索列表中, 选择一个或多个搜索, 然后单击 "**批量搜索编辑器** ![批量搜索编辑器"](media/1ddb3d18-2f00-4a7b-98a6-817ca5ec7014.png)按钮。</span><span class="sxs-lookup"><span data-stu-id="3e91c-114">In the list of searches, select one or more searches, and then click **Bulk Search Editor** ![Bulk Search Editor button](media/1ddb3d18-2f00-4a7b-98a6-817ca5ec7014.png).</span></span>
    
    ![选择一个或多个搜索, 然后单击 "批量搜索编辑器"](media/600c9716-89a2-4451-b111-fa7cfaad2006.png)
  
    <span data-ttu-id="3e91c-116">以下信息显示在批量搜索编辑器的 "**查询**" 页上。</span><span class="sxs-lookup"><span data-stu-id="3e91c-116">The following information is displayed on the **Queries** page of the Bulk Search Editor.</span></span> 
    
    !["批量搜索编辑器" 页将显示所选搜索的查询](media/189659af-cc78-4479-b0bc-a93decad2f6c.png)
  
    <span data-ttu-id="3e91c-118">a.</span><span class="sxs-lookup"><span data-stu-id="3e91c-118">a.</span></span> <span data-ttu-id="3e91c-119">"**搜索**" 列显示内容搜索的名称。</span><span class="sxs-lookup"><span data-stu-id="3e91c-119">The **Search** column displays the name of the Content Search.</span></span> <span data-ttu-id="3e91c-120">如前面所述, 您可以编辑查询以查找多个搜索。</span><span class="sxs-lookup"><span data-stu-id="3e91c-120">As previously stated, you can edit the query for multiple searches.</span></span> 
    
    <span data-ttu-id="3e91c-121">b.</span><span class="sxs-lookup"><span data-stu-id="3e91c-121">b.</span></span> <span data-ttu-id="3e91c-122">"**查询**" 列显示**搜索**列中列出的内容搜索的查询。</span><span class="sxs-lookup"><span data-stu-id="3e91c-122">The **Query** column displays the query for the Content Search listed in the **Search** column.</span></span> <span data-ttu-id="3e91c-123">如果使用关键字列表功能创建了查询, 关键字将由文本 \* \* `(c:s)`分隔 **。这表示关键字是通过**OR**运算符连接的。此外, 如果查询包含条件, 关键字和条件由文本 \* \* `(c:c)`分隔**。</span><span class="sxs-lookup"><span data-stu-id="3e91c-123">If the query was created using the keyword list feature, the keywords are separated by the text \*\* `(c:s)`**. This indicates that the keywords are connected by the **OR** operator. Additionally, if the query includes conditions, the keywords and the conditions are separated by the text \*\* `(c:c)`**.</span></span> <span data-ttu-id="3e91c-124">这表示关键字 (或关键字阶段) 通过**and**运算符连接到条件。</span><span class="sxs-lookup"><span data-stu-id="3e91c-124">This indicates that the keywords (or keyword phases) are connected to the conditions by the **AND** operator.</span></span> <span data-ttu-id="3e91c-125">例如, 在前面的屏幕截图中, 对于搜索 ContosoSearch1, KQL 查询等效`customer (c:s) pricing(c:c)(date=2000-01-01..2016-09-30)`于。 `(customer OR pricing) AND (date=2002-01-01..2016-09-30)`</span><span class="sxs-lookup"><span data-stu-id="3e91c-125">For example, in the previous screenshot the for search ContosoSearch1, the KQL query that is equivalent to  `customer (c:s) pricing(c:c)(date=2000-01-01..2016-09-30)` would be  `(customer OR pricing) AND (date=2002-01-01..2016-09-30)`.</span></span>
    
3. <span data-ttu-id="3e91c-126">若要编辑查询, 请单击要更改的查询的单元格, 并执行下列操作之一。</span><span class="sxs-lookup"><span data-stu-id="3e91c-126">To edit a query, click in the cell of the query that you want to change and doing one of the following things.</span></span> <span data-ttu-id="3e91c-127">请注意, 当您单击该单元格时, 该单元格由一个蓝框加上边框。</span><span class="sxs-lookup"><span data-stu-id="3e91c-127">Note that the cell is bordered by a blue box when you click it.</span></span>
    
   - <span data-ttu-id="3e91c-128">在单元格中键入新的查询。</span><span class="sxs-lookup"><span data-stu-id="3e91c-128">Type the new query in the cell.</span></span> <span data-ttu-id="3e91c-129">请注意, 不能编辑查询的一部分。</span><span class="sxs-lookup"><span data-stu-id="3e91c-129">Note that you can't edit a portion of the query.</span></span> <span data-ttu-id="3e91c-130">您必须键入整个查询。</span><span class="sxs-lookup"><span data-stu-id="3e91c-130">You have to type the entire query.</span></span>
    
      <span data-ttu-id="3e91c-131">或</span><span class="sxs-lookup"><span data-stu-id="3e91c-131">Or</span></span>
    
    - <span data-ttu-id="3e91c-132">将新查询粘贴到单元格中。</span><span class="sxs-lookup"><span data-stu-id="3e91c-132">Paste a new query in the cell.</span></span> <span data-ttu-id="3e91c-133">这假设您已从文件 (如文本文件或 Excel 文件) 复制查询文本。</span><span class="sxs-lookup"><span data-stu-id="3e91c-133">This assumes that you've copied the query text from a file, such as a text file or an Excel file.</span></span>
    
4. <span data-ttu-id="3e91c-134">编辑完 "**查询**" 页面上的一个或多个查询后, 单击 "**保存**"。</span><span class="sxs-lookup"><span data-stu-id="3e91c-134">After you've edited one or more queries on the **Queries** page, click **Save**.</span></span>
    
    <span data-ttu-id="3e91c-135">修订后的查询显示在所选搜索的 "**查询**" 列中。</span><span class="sxs-lookup"><span data-stu-id="3e91c-135">The revised query is displayed in the **Query** column for the selected search.</span></span> 
    
5. <span data-ttu-id="3e91c-136">单击 "**关闭**" 以关闭 "批量搜索编辑器"。</span><span class="sxs-lookup"><span data-stu-id="3e91c-136">Click **Close** to close the Bulk Search Editor.</span></span> 
    
6. <span data-ttu-id="3e91c-137">在 "**内容搜索**" 页上, 选择您编辑的搜索, 然后单击 "**开始**搜索" 以使用修订后的查询重新启动搜索。</span><span class="sxs-lookup"><span data-stu-id="3e91c-137">On the **Content search** page, select the search that you edited, and click **Start** search to restart the search using the revised query.</span></span> 
    
<span data-ttu-id="3e91c-138">下面是使用批量搜索编辑器编辑查询的一些提示:</span><span class="sxs-lookup"><span data-stu-id="3e91c-138">Here are some tips for editing queries using the Bulk Search Editor:</span></span>
  
- <span data-ttu-id="3e91c-139">将现有查询 (通过使用**Ctrl C** ) 复制到文本文件中。</span><span class="sxs-lookup"><span data-stu-id="3e91c-139">Copy the existing query (by using **Ctrl C** ) to a text file.</span></span> <span data-ttu-id="3e91c-140">在文本文件中编辑查询, 然后复制修订后的查询并将其粘贴 (使用**Ctrl + V** ) 回到 "**查询**" 页上的单元格。</span><span class="sxs-lookup"><span data-stu-id="3e91c-140">Edit the query in the text file, and then copy the revised query and paste it (using **Ctrl V** ) back into the cell on the **Queries** page.</span></span> 
    
- <span data-ttu-id="3e91c-141">您还可以从其他应用程序 (如 Microsoft Word 或 Microsoft Excel) 复制查询。</span><span class="sxs-lookup"><span data-stu-id="3e91c-141">You can also copy queries from other applications (such as Microsoft Word or Microsoft Excel).</span></span> <span data-ttu-id="3e91c-142">但是, 请注意, 您可能无意中使用批量搜索编辑器将不受支持的字符添加到查询中。</span><span class="sxs-lookup"><span data-stu-id="3e91c-142">However, be aware that you might inadvertently add unsupported characters to a query using the Bulk Search Editor.</span></span> <span data-ttu-id="3e91c-143">阻止不受支持的字符的最佳方式是只在 "**查询**" 页上的单元格中键入查询。</span><span class="sxs-lookup"><span data-stu-id="3e91c-143">The best way to prevent unsupported characters is to just type the query in a cell on the **Queries** page.</span></span> <span data-ttu-id="3e91c-144">或者，也可以从 Word 或 Excel 复制查询，然后将其粘贴到纯文本编辑器（如 Microsoft 记事本）文件中。</span><span class="sxs-lookup"><span data-stu-id="3e91c-144">Alternatively, you can copy a query from Word or Excel and then paste it to file in a plain text editor, such as Microsoft Notepad.</span></span> <span data-ttu-id="3e91c-145">接下来，保存文本文件，并在" **编码**"下拉列表中选择" **ANSI**"。</span><span class="sxs-lookup"><span data-stu-id="3e91c-145">Then save the text file and select **ANSI** in the **Encoding** drop-down list.</span></span> <span data-ttu-id="3e91c-146">这会删除所有格式和不受支持的字符。</span><span class="sxs-lookup"><span data-stu-id="3e91c-146">This will remove any formatting and unsupported characters.</span></span> <span data-ttu-id="3e91c-147">然后, 可以将文本文件中的查询复制并粘贴到**查询**页面。</span><span class="sxs-lookup"><span data-stu-id="3e91c-147">Then you can copy and paste the query from the text file to the **Queries** page.</span></span> 
    
  
## <a name="use-the-bulk-search-editor-to-change-content-locations"></a><span data-ttu-id="3e91c-148">使用批量搜索编辑器更改内容位置</span><span class="sxs-lookup"><span data-stu-id="3e91c-148">Use the Bulk Search Editor to change content locations</span></span>

1. <span data-ttu-id="3e91c-149">在一个或多个所选搜索的批量搜索编辑器中, 单击 "**启用批量位置编辑器**", 然后单击页面上显示的 "**位置**" 链接。</span><span class="sxs-lookup"><span data-stu-id="3e91c-149">In the Bulk Search Editor for one or more selected searches, click **Enable bulk location editor**, and then click the **Locations** link that is displayed on the page.</span></span> 
    
    <span data-ttu-id="3e91c-150">在批量搜索编辑器的 "**位置**" 页上显示以下信息。</span><span class="sxs-lookup"><span data-stu-id="3e91c-150">The following information is displayed on the **Locations** page of the Bulk Search Editor.</span></span> 
    
    ![单击 "启用批量位置编辑器", 然后单击 "位置" 以添加或删除内容位置](media/a5a468ce-bd63-4c53-bc37-ff64cf769e59.png)
  
    <span data-ttu-id="3e91c-152">a.</span><span class="sxs-lookup"><span data-stu-id="3e91c-152">a.</span></span> <span data-ttu-id="3e91c-153">**要搜索的邮箱**此部分显示每个选定的内容搜索的列以及搜索中包含的每个邮箱的行。</span><span class="sxs-lookup"><span data-stu-id="3e91c-153">**Mailboxes to search**This section displays a column for each selected Content Search, and row for each mailbox that's included in the search.</span></span> <span data-ttu-id="3e91c-154">复选标记表示该邮箱包含在搜索中。</span><span class="sxs-lookup"><span data-stu-id="3e91c-154">A checkmark indicates that the mailbox is included in the search.</span></span> <span data-ttu-id="3e91c-155">您可以通过在空白行中键入邮箱的电子邮件地址, 然后单击要将其添加到的内容搜索的复选框, 将其他邮箱添加到搜索中。</span><span class="sxs-lookup"><span data-stu-id="3e91c-155">You can add additional mailboxes to a search by typing the email address of the mailbox in a blank row and then clicking the checkbox for the Content Search that you want to add it to.</span></span> <span data-ttu-id="3e91c-156">或者, 可以通过清除该复选框从搜索中删除邮箱。</span><span class="sxs-lookup"><span data-stu-id="3e91c-156">Or you can remove a mailbox from a search by clearing the checkbox.</span></span>
    
    <span data-ttu-id="3e91c-157">b.</span><span class="sxs-lookup"><span data-stu-id="3e91c-157">b.</span></span> <span data-ttu-id="3e91c-158">**要搜索的 SharePoint 网站**此部分为每个所选内容搜索中包含的每个 SharePoint 和 OneDrive 网站显示一行。</span><span class="sxs-lookup"><span data-stu-id="3e91c-158">**SharePoint sites to search**This section displays a row for each SharePoint and OneDrive site that included in each selected Content Search.</span></span> <span data-ttu-id="3e91c-159">选中标记表示该网站包含在搜索中。</span><span class="sxs-lookup"><span data-stu-id="3e91c-159">A checkmark indicates that the site is included in the search.</span></span> <span data-ttu-id="3e91c-160">通过在空白行中键入网站的 URL, 然后单击要将其添加到的内容搜索的复选框, 可以向搜索中添加其他网站。</span><span class="sxs-lookup"><span data-stu-id="3e91c-160">You can add additional sites to a search by typing the URL for the site in a blank row and then and clicking the checkbox for the Content Search that you want to add it to.</span></span> <span data-ttu-id="3e91c-161">或者, 可以通过清除该复选框从搜索中删除网站。</span><span class="sxs-lookup"><span data-stu-id="3e91c-161">Or you can remove a site from a search by clearing the checkbox.</span></span>
    
    <span data-ttu-id="3e91c-162">c.</span><span class="sxs-lookup"><span data-stu-id="3e91c-162">c.</span></span> <span data-ttu-id="3e91c-163">**其他搜索选项**此部分指示搜索中是否包含未编制索引的项目和公用文件夹。</span><span class="sxs-lookup"><span data-stu-id="3e91c-163">**Other search options**This section indicates whether unindexed items and public folders are included in the search.</span></span> <span data-ttu-id="3e91c-164">若要包括这些, 请确保已选中 "" 复选框。</span><span class="sxs-lookup"><span data-stu-id="3e91c-164">To include these, make sure the checkbox is selected.</span></span> <span data-ttu-id="3e91c-165">若要删除它们, 请清除该复选框。</span><span class="sxs-lookup"><span data-stu-id="3e91c-165">To remove them, clear the checkbox.</span></span>
    
2. <span data-ttu-id="3e91c-166">在编辑完 "**位置**" 页上的一个或多个分区之后, 单击 "**保存**"。</span><span class="sxs-lookup"><span data-stu-id="3e91c-166">After you've edited one or more of the sections on the **Locations** page, click **Save**.</span></span>
    
    <span data-ttu-id="3e91c-167">修订后的内容位置将显示在所选搜索的相应部分中。</span><span class="sxs-lookup"><span data-stu-id="3e91c-167">The revised content locations are displayed in the appropriate section for the selected searches.</span></span>
    
3. <span data-ttu-id="3e91c-168">单击 "**关闭**" 以关闭 "批量搜索编辑器"。</span><span class="sxs-lookup"><span data-stu-id="3e91c-168">Click **Close** to close the Bulk Search Editor.</span></span> 
    
4. <span data-ttu-id="3e91c-169">在 "**内容搜索**" 页上, 选择您编辑的搜索, 然后单击 "**启动**搜索" 以使用修订后的内容位置重新启动搜索。</span><span class="sxs-lookup"><span data-stu-id="3e91c-169">On the **Content search** page, select the search that you edited, and click **Start** search to restart the search using the revised content locations.</span></span> 
    
<span data-ttu-id="3e91c-170">下面是使用批量搜索编辑器编辑内容位置的一些提示:</span><span class="sxs-lookup"><span data-stu-id="3e91c-170">Here are some tips for editing content locations using the Bulk Search Editor:</span></span>
  
- <span data-ttu-id="3e91c-171">您可以编辑内容搜索以搜索组织中的所有邮箱或网站, 方法是在 "**要搜索的邮箱**" 或 "要搜索的**SharePoint 网站**" 部分中键入**所有**邮箱或网站, 然后单击该复选框。</span><span class="sxs-lookup"><span data-stu-id="3e91c-171">You can edit Content Searches to search all mailboxes or sites in the organization by typing **All** in a blank row in the **Mailboxes to search** or **SharePoint sites to search** section and then clicking the checkbox.</span></span> 
    
- <span data-ttu-id="3e91c-172">可以通过从文本文件或 Excel 文件中复制多个行并将它们粘贴到 "**位置**" 页上的节中, 将多个内容位置添加到一个或多个搜索中。</span><span class="sxs-lookup"><span data-stu-id="3e91c-172">You can add multiple content locations to one or more searches by copying multiple rows from a text file or an Excel file and then pasting them to a section on the **Locations** page.</span></span> <span data-ttu-id="3e91c-173">在添加新位置之后, 请务必选中要向其添加位置的每个搜索的复选框。</span><span class="sxs-lookup"><span data-stu-id="3e91c-173">After you add new locations, be sure to select the checkbox for each search that you want add the location to.</span></span> 
    
    > [!TIP]
    > <span data-ttu-id="3e91c-174">若要为组织中的所有用户生成电子邮件地址列表, 请在 "[步骤 2: 生成用户列表](search-the-mailbox-and-onedrive-for-business-for-a-list-of-users.md#step-2-generate-a-list-of-users)" 中的步骤2中运行 PowerShell 命令。</span><span class="sxs-lookup"><span data-stu-id="3e91c-174">To generate a list of email addresses for all the users in your organization, run the PowerShell command in Step 2 in [Step 2: Generate a list of users](search-the-mailbox-and-onedrive-for-business-for-a-list-of-users.md#step-2-generate-a-list-of-users).</span></span> <span data-ttu-id="3e91c-175">或者按照[获取组织中所有用户 Onedrive url 的列表](https://docs.microsoft.com/onedrive/list-onedrive-urls)中的步骤生成组织中所有 onedrive for business 网站的列表。</span><span class="sxs-lookup"><span data-stu-id="3e91c-175">Or follow the steps in [Get a list of all user OneDrive URLs in your organization](https://docs.microsoft.com/onedrive/list-onedrive-urls) to generate a list of all OneDrive for Business sites in your organization.</span></span> <span data-ttu-id="3e91c-176">请注意, 您必须将组织的 "我的网站" 域的 URL (例如, https://contoso-my.sharepoint.com)添加到由脚本创建的 OneDrive for business 网站)。</span><span class="sxs-lookup"><span data-stu-id="3e91c-176">Note that you'll have to append the URL for your organization's MySite domain (for example, https://contoso-my.sharepoint.com) to the OneDrive for Business sites that's created by the script.</span></span> <span data-ttu-id="3e91c-177">在拥有电子邮件地址或 OneDrive for Business 网站的列表后, 可以将其复制并粘贴到批量搜索编辑器中的 "**位置**" 页。</span><span class="sxs-lookup"><span data-stu-id="3e91c-177">After you have list of email addresses or OneDrive for Business sites, you can copy and paste them to the **Locations** page in the Bulk Search Editor.</span></span> 
  
- <span data-ttu-id="3e91c-178">单击 "**保存**" 以在批量搜索编辑器中保存更改后, 您添加到搜索中的邮箱的电子邮件地址将会得到验证。</span><span class="sxs-lookup"><span data-stu-id="3e91c-178">After you click **Save** to save changes in Bulk Search Editor, the email address for mailboxes that you added to a search will be validated.</span></span> <span data-ttu-id="3e91c-179">如果电子邮件地址不存在, 则会显示一条错误消息, 指出邮箱无法定位。</span><span class="sxs-lookup"><span data-stu-id="3e91c-179">If the email address doesn't exist, an error message is displayed saying the mailbox can't be located.</span></span> <span data-ttu-id="3e91c-180">请注意, 网站 Url 不会进行验证。</span><span class="sxs-lookup"><span data-stu-id="3e91c-180">Note that URLs for sites aren't validated.</span></span> 
  

