---
title: 批量编辑内容搜索
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: 12/29/2016
ms.audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid: MOE150
ms.assetid: 39e4654a-9588-41f6-892b-c33ab57bfbe2
description: 使用 Office 365 或 Microsoft 365 中的安全与合规中心中的批量搜索编辑器快速更改一个或多个内容搜索的查询和内容位置。
ms.openlocfilehash: 3a484ad689b1c638e0e14ed1643edea0f2f56c09
ms.sourcegitcommit: 0017dc6a5f81c165d9dfd88be39a6bb17856582e
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/23/2019
ms.locfileid: "32243831"
---
# <a name="bulk-edit-content-searches"></a>批量编辑内容搜索

您可以使用内容搜索工具中的批量搜索编辑器同时编辑多个搜索。 使用此工具可以快速更改一个或多个搜索的查询和内容位置。 然后, 您可以重新运行搜索并为修订后的搜索获取新的估计搜索结果。 编辑器还允许您从 Microsoft Excel 文件或文本文件中复制并粘贴查询和内容位置。 这意味着您可以使用搜索统计信息工具查看一个或多个搜索的统计信息, 将统计信息导出到 CSV 文件, 您可以在其中编辑 Excel 中的查询和内容位置。 然后, 使用批量搜索编辑器将修订后的查询和内容位置添加到搜索中。 在您修订了一个或多个搜索之后, 可以重新启动它们并获取新的估计搜索结果。
  
有关使用搜索统计信息工具的详细信息, 请参阅[查看内容搜索结果的关键字统计](view-keyword-statistics-for-content-search.md)信息。
  
## <a name="use-the-bulk-search-editor-to-change-queries"></a>使用批量搜索编辑器更改查询

1. 转到[https://protection.office.com](https://protection.office.com), 然后单击 "**搜索** \> **内容搜索**"。
    
2. 在搜索列表中, 选择一个或多个搜索, 然后单击 "**批量搜索编辑器** ![批量搜索编辑器"](media/1ddb3d18-2f00-4a7b-98a6-817ca5ec7014.png)按钮。
    
    ![选择一个或多个搜索, 然后单击 "批量搜索编辑器"](media/600c9716-89a2-4451-b111-fa7cfaad2006.png)
  
    以下信息显示在批量搜索编辑器的 "**查询**" 页上。 
    
    !["批量搜索编辑器" 页将显示所选搜索的查询](media/189659af-cc78-4479-b0bc-a93decad2f6c.png)
  
    a. "**搜索**" 列显示内容搜索的名称。 如前面所述, 您可以编辑查询以查找多个搜索。 
    
    b. "**查询**" 列显示**搜索**列中列出的内容搜索的查询。 如果使用关键字列表功能创建了查询, 关键字将由文本 * * `(c:s)`分隔 **。这表示关键字是通过**OR**运算符连接的。此外, 如果查询包含条件, 关键字和条件由文本 * * `(c:c)`分隔**。 这表示关键字 (或关键字阶段) 通过**and**运算符连接到条件。 例如, 在前面的屏幕截图中, 对于搜索 ContosoSearch1, KQL 查询等效`customer (c:s) pricing(c:c)(date=2000-01-01..2016-09-30)`于。 `(customer OR pricing) AND (date=2002-01-01..2016-09-30)`
    
3. 若要编辑查询, 请单击要更改的查询的单元格, 并执行下列操作之一。 请注意, 当您单击该单元格时, 该单元格由一个蓝框加上边框。
    
   - 在单元格中键入新的查询。 请注意, 不能编辑查询的一部分。 您必须键入整个查询。
    
      或
    
    - 将新查询粘贴到单元格中。 这假设您已从文件 (如文本文件或 Excel 文件) 复制查询文本。
    
4. 编辑完 "**查询**" 页面上的一个或多个查询后, 单击 "**保存**"。
    
    修订后的查询显示在所选搜索的 "**查询**" 列中。 
    
5. 单击 "**关闭**" 以关闭 "批量搜索编辑器"。 
    
6. 在 "**内容搜索**" 页上, 选择您编辑的搜索, 然后单击 "**开始**搜索" 以使用修订后的查询重新启动搜索。 
    
下面是使用批量搜索编辑器编辑查询的一些提示:
  
- 将现有查询 (通过使用**Ctrl C** ) 复制到文本文件中。 在文本文件中编辑查询, 然后复制修订后的查询并将其粘贴 (使用**Ctrl + V** ) 回到 "**查询**" 页上的单元格。 
    
- 您还可以从其他应用程序 (如 microsoft Word 或 microsoft Excel) 复制查询。 但是, 请注意, 您可能无意中使用批量搜索编辑器将不受支持的字符添加到查询中。 阻止不受支持的字符的最佳方式是只在 "**查询**" 页上的单元格中键入查询。 或者，也可以从 Word 或 Excel 复制查询，然后将其粘贴到纯文本编辑器（如 Microsoft 记事本）文件中。 接下来，保存文本文件，并在" **编码**"下拉列表中选择" **ANSI**"。 这会删除所有格式和不受支持的字符。 然后, 可以将文本文件中的查询复制并粘贴到**查询**页面。 
    
  
## <a name="use-the-bulk-search-editor-to-change-content-locations"></a>使用批量搜索编辑器更改内容位置

1. 在一个或多个所选搜索的批量搜索编辑器中, 单击 "**启用批量位置编辑器**", 然后单击页面上显示的 "**位置**" 链接。 
    
    在批量搜索编辑器的 "**位置**" 页上显示以下信息。 
    
    ![单击 "启用批量位置编辑器", 然后单击 "位置" 以添加或删除内容位置](media/a5a468ce-bd63-4c53-bc37-ff64cf769e59.png)
  
    a. **要搜索的邮箱**此部分显示每个选定的内容搜索的列以及搜索中包含的每个邮箱的行。 复选标记表示该邮箱包含在搜索中。 您可以通过在空白行中键入邮箱的电子邮件地址, 然后单击要将其添加到的内容搜索的复选框, 将其他邮箱添加到搜索中。 或者, 可以通过清除该复选框从搜索中删除邮箱。
    
    b. **要搜索的 SharePoint 网站**此部分为每个所选内容搜索中包含的每个 SharePoint 和 OneDrive 网站显示一行。 选中标记表示该网站包含在搜索中。 通过在空白行中键入网站的 URL, 然后单击要将其添加到的内容搜索的复选框, 可以向搜索中添加其他网站。 或者, 可以通过清除该复选框从搜索中删除网站。
    
    c. **其他搜索选项**此部分指示搜索中是否包含未编制索引的项目和公用文件夹。 若要包括这些, 请确保已选中 "" 复选框。 若要删除它们, 请清除该复选框。
    
2. 在编辑完 "**位置**" 页上的一个或多个分区之后, 单击 "**保存**"。
    
    修订后的内容位置将显示在所选搜索的相应部分中。
    
3. 单击 "**关闭**" 以关闭 "批量搜索编辑器"。 
    
4. 在 "**内容搜索**" 页上, 选择您编辑的搜索, 然后单击 "**启动**搜索" 以使用修订后的内容位置重新启动搜索。 
    
下面是使用批量搜索编辑器编辑内容位置的一些提示:
  
- 您可以编辑内容搜索以搜索组织中的所有邮箱或网站, 方法是在 "**要搜索的邮箱**" 或 "要搜索的**SharePoint 网站**" 部分中键入**所有**邮箱或网站, 然后单击该复选框。 
    
- 可以通过从文本文件或 Excel 文件中复制多个行并将它们粘贴到 "**位置**" 页上的节中, 将多个内容位置添加到一个或多个搜索中。 在添加新位置之后, 请务必选中要向其添加位置的每个搜索的复选框。 
    
    > [!TIP]
    > 若要为组织中的所有用户生成电子邮件地址列表, 请在 "使用内容搜索" 中的步骤2中运行 PowerShell 命令, 以在[邮箱和 OneDrive for business 网站中搜索用户列表](search-the-mailbox-and-onedrive-for-business-for-a-list-of-users.md#step2)。 或使用中的脚本[创建组织中所有 onedrive 位置的列表](https://support.office.com/article/8e200cb2-c768-49cb-88ec-53493e8ad80a), 以生成组织中所有 onedrive for business 网站的列表。 请注意, 您必须将的 organization's "我的网站" 域的 URL (例如, https://contoso-my.sharepoint.com)由脚本创建的 OneDrive for business 网站) 追加。 在拥有电子邮件地址或 OneDrive for business 网站的列表后, 可以将其复制并粘贴到批量搜索编辑器中的 "**位置**" 页。 
  
- 单击 "**保存**" 以在批量搜索编辑器中保存更改后, 您添加到搜索中的邮箱的电子邮件地址将会得到验证。 如果电子邮件地址不存在, 则会显示一条错误消息, 指出邮箱无法定位。 请注意, 网站 url 不会进行验证。 
  

