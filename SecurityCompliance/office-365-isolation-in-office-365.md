---
title: office 365 中的 office 365 隔离和访问控制
ms.author: robmazz
author: robmazz
manager: laurawi
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
description: '摘要: Office 365 的各种应用程序中的隔离和访问控制说明。'
ms.openlocfilehash: 748da21f5b5048bb4ae4c14700ed482fd6d0058c
ms.sourcegitcommit: e23b84ef4eee9cccec7205826b71ddfe9aaac2f8
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 04/28/2019
ms.locfileid: "33402890"
---
# <a name="isolation-and-access-control-in-office-365"></a><span data-ttu-id="95f31-103">Office 365 中的隔离和访问控制</span><span class="sxs-lookup"><span data-stu-id="95f31-103">Isolation and Access Control in Office 365</span></span>

<span data-ttu-id="95f31-104">Azure Active Directory 和 Office 365 使用高度复杂的数据模型, 其中包括数十个服务、数百个实体、数千个关系和数十个属性。</span><span class="sxs-lookup"><span data-stu-id="95f31-104">Azure Active Directory and Office 365 use a highly complex data model that includes tens of services, hundreds of entities, thousands of relationships, and tens of thousands of attributes.</span></span> <span data-ttu-id="95f31-105">在较高级别, Azure Active Directory 和服务目录是使用基于状态的复制协议保持同步的租户和收件人的容器。</span><span class="sxs-lookup"><span data-stu-id="95f31-105">At a high level, Azure Active Directory and the service directories are the containers of tenants and recipients kept in sync using state-based replication protocols.</span></span> <span data-ttu-id="95f31-106">除了 Azure Active directory 中保留的目录信息外, 每个服务工作负载都有自己的目录服务基础结构。</span><span class="sxs-lookup"><span data-stu-id="95f31-106">In addition to the directory information held within Azure Active Directory, each of the service workloads have their own directory services infrastructure.</span></span>
 
![Office 365 租户数据同步](media/office-365-isolation-tenant-data-sync.png)

<span data-ttu-id="95f31-108">在此模型中, 没有一个目录数据源。</span><span class="sxs-lookup"><span data-stu-id="95f31-108">Within this model, there is no single source of directory data.</span></span> <span data-ttu-id="95f31-109">特定系统拥有单独的数据片段, 但没有单个系统保存所有数据。</span><span class="sxs-lookup"><span data-stu-id="95f31-109">Specific systems own individual pieces of data, but no single system holds all the data.</span></span> <span data-ttu-id="95f31-110">在此数据模型中, Office 365 服务与 Azure Active Directory 合作。</span><span class="sxs-lookup"><span data-stu-id="95f31-110">Office 365 services cooperate with Azure Active Directory in this data model.</span></span> <span data-ttu-id="95f31-111">Azure Active Directory 是共享数据的 "真实系统", 它通常是每个服务使用的小型和静态数据。</span><span class="sxs-lookup"><span data-stu-id="95f31-111">Azure Active Directory is the "system of truth" for shared data, which is typically small and static data used by every service.</span></span> <span data-ttu-id="95f31-112">Office 365 和 Azure Active Directory 中使用的联合模型提供了数据的共享视图。</span><span class="sxs-lookup"><span data-stu-id="95f31-112">The federated model used within Office 365 and Azure Active Directory provides the shared view of the data.</span></span>

<span data-ttu-id="95f31-113">Office 365 同时使用物理存储和 Azure 云存储。</span><span class="sxs-lookup"><span data-stu-id="95f31-113">Office 365 uses both physical storage and Azure cloud storage.</span></span> <span data-ttu-id="95f31-114">exchange online (包括 exchange online Protection) 和 Skype for business 将自己的存储用于客户数据。</span><span class="sxs-lookup"><span data-stu-id="95f31-114">Exchange Online (including Exchange Online Protection) and Skype for Business use their own storage for customer data.</span></span> <span data-ttu-id="95f31-115">SharePoint Online 同时使用 SQL Server 存储和 Azure 存储, 因此需要在存储级别对客户数据进行额外的隔离。</span><span class="sxs-lookup"><span data-stu-id="95f31-115">SharePoint Online uses both SQL Server storage and Azure Storage, hence the need for additional isolation of customer data at the storage level.</span></span>

## <a name="exchange-online"></a><span data-ttu-id="95f31-116">Exchange Online</span><span class="sxs-lookup"><span data-stu-id="95f31-116">Exchange Online</span></span>

<span data-ttu-id="95f31-117">Exchange Online 将客户数据存储在邮箱中。</span><span class="sxs-lookup"><span data-stu-id="95f31-117">Exchange Online stores customer data within mailboxes.</span></span> <span data-ttu-id="95f31-118">邮箱托管在称为 "邮箱数据库" 的可扩展存储引擎 (ESE) 数据库中。</span><span class="sxs-lookup"><span data-stu-id="95f31-118">Mailboxes are hosted within Extensible Storage Engine (ESE) databases called mailbox databases.</span></span> <span data-ttu-id="95f31-119">这包括用户邮箱、链接邮箱、共享邮箱和公用文件夹邮箱。</span><span class="sxs-lookup"><span data-stu-id="95f31-119">This includes user mailboxes, linked mailboxes, shared mailboxes, and public folder mailboxes.</span></span> <span data-ttu-id="95f31-120">用户邮箱包括保存的 Skype for business 内容, 如对话历史记录。</span><span class="sxs-lookup"><span data-stu-id="95f31-120">User mailboxes include saved Skype for Business content, such as conversation histories.</span></span>

<span data-ttu-id="95f31-121">用户邮箱内容包括:</span><span class="sxs-lookup"><span data-stu-id="95f31-121">User mailbox content includes:</span></span>

- <span data-ttu-id="95f31-122">电子邮件和电子邮件附件</span><span class="sxs-lookup"><span data-stu-id="95f31-122">Emails and email attachments</span></span>
- <span data-ttu-id="95f31-123">日历和忙/闲信息</span><span class="sxs-lookup"><span data-stu-id="95f31-123">Calendaring and free/busy information</span></span>
- <span data-ttu-id="95f31-124">联系人</span><span class="sxs-lookup"><span data-stu-id="95f31-124">Contacts</span></span>
- <span data-ttu-id="95f31-125">任务</span><span class="sxs-lookup"><span data-stu-id="95f31-125">Tasks</span></span>
- <span data-ttu-id="95f31-126">注释</span><span class="sxs-lookup"><span data-stu-id="95f31-126">Notes</span></span>
- <span data-ttu-id="95f31-127">组</span><span class="sxs-lookup"><span data-stu-id="95f31-127">Groups</span></span>
- <span data-ttu-id="95f31-128">推理数据</span><span class="sxs-lookup"><span data-stu-id="95f31-128">Inference data</span></span>

<span data-ttu-id="95f31-129">Exchange Online 中的每个邮箱数据库包含来自多个租户的邮箱。</span><span class="sxs-lookup"><span data-stu-id="95f31-129">Each mailbox database within Exchange Online contains mailboxes from multiple tenants.</span></span> <span data-ttu-id="95f31-130">授权代码可保护每个邮箱, 包括租赁内。</span><span class="sxs-lookup"><span data-stu-id="95f31-130">An authorization code secures each mailbox, including within a tenancy.</span></span> <span data-ttu-id="95f31-131">默认情况下, 只有分配的用户才有权访问邮箱。</span><span class="sxs-lookup"><span data-stu-id="95f31-131">By default, only the assigned user has access to a mailbox.</span></span> <span data-ttu-id="95f31-132">保护邮箱的访问控制列表 (ACL) 包含在租户级别通过 Azure Active Directory 进行身份验证的标识。</span><span class="sxs-lookup"><span data-stu-id="95f31-132">The access control list (ACL) that secures a mailbox contains an identity authenticated by Azure Active Directory at the tenant level.</span></span> <span data-ttu-id="95f31-133">每个租户的邮箱仅限于对租户的身份验证提供程序的身份进行身份验证, 其中仅包含来自该租户的用户。</span><span class="sxs-lookup"><span data-stu-id="95f31-133">The mailboxes for each tenant are limited to identities authenticated against the tenant's authentication provider, which includes only users from that tenant.</span></span> <span data-ttu-id="95f31-134">租户 a 中的用户无法以任何方式获取租户 B 中的内容, 除非租户 a 明确批准。</span><span class="sxs-lookup"><span data-stu-id="95f31-134">Content in tenant A cannot in any way be obtained by users in tenant B, unless explicitly approved by tenant A.</span></span>

## <a name="skype-for-business"></a><span data-ttu-id="95f31-135">Skype for Business</span><span class="sxs-lookup"><span data-stu-id="95f31-135">Skype for Business</span></span>

<span data-ttu-id="95f31-136">Skype for business 将数据存储在不同的位置:</span><span class="sxs-lookup"><span data-stu-id="95f31-136">Skype for Business stores data in various places:</span></span>

- <span data-ttu-id="95f31-137">用户和帐户信息 (包括连接终结点、租户 id、拨号计划、漫游设置、状态状态、联系人列表等) 存储在 skype for business Active Directory 服务器和各种 skype for business 数据库服务器中。</span><span class="sxs-lookup"><span data-stu-id="95f31-137">User and account information, which includes connection endpoints, tenant IDs, dial plans, roaming settings, presence state, contact lists, etc., is stored in the Skype for Business Active Directory servers, and in various Skype for Business database servers.</span></span> <span data-ttu-id="95f31-138">如果为用户启用了这两个产品或 Skype for business 服务器 (如果用户不是这样), 则联系人列表存储在用户的 Exchange Online 邮箱中。</span><span class="sxs-lookup"><span data-stu-id="95f31-138">Contact lists are stored in the user's Exchange Online mailbox if the user is enabled for both products, or on Skype for Business servers if the user is not.</span></span> <span data-ttu-id="95f31-139">Skype for business 数据库服务器不按租户分区, 但通过基于角色的访问控制 (RBAC) 强制实施多租户数据隔离。</span><span class="sxs-lookup"><span data-stu-id="95f31-139">Skype for Business database servers are not partitioned per-tenant, but multi-tenancy isolation of data is enforced through role-based access control (RBAC).</span></span>
- <span data-ttu-id="95f31-140">会议内容和上载的数据存储在分布式文件系统 (DFS) 共享上。</span><span class="sxs-lookup"><span data-stu-id="95f31-140">Meeting content and uploaded data is stored on Distributed File System (DFS) shares.</span></span> <span data-ttu-id="95f31-141">如果启用此内容, 还可以将其存档在 Exchange Online 中。</span><span class="sxs-lookup"><span data-stu-id="95f31-141">This content can also be archived in Exchange Online if enabled.</span></span> <span data-ttu-id="95f31-142">DFS 共享不按租户分区。</span><span class="sxs-lookup"><span data-stu-id="95f31-142">The DFS shares are not partitioned per-tenant.</span></span> <span data-ttu-id="95f31-143">内容是通过 RBAC 强制实施的, 而多租户则通过 RBAC 进行保护。</span><span class="sxs-lookup"><span data-stu-id="95f31-143">the content is secured with ACLs and multi-tenancy is enforced through RBAC.</span></span>
- <span data-ttu-id="95f31-144">呼叫详细信息记录 (如呼叫历史记录、im 会话、应用程序共享、im 历史记录等) 也可以存储在 Exchange Online 中, 但大多数呼叫详细信息记录临时存储在呼叫详细信息记录 (CDR) 服务器上。</span><span class="sxs-lookup"><span data-stu-id="95f31-144">Call detail records, which are the activity history, such as call history, IM sessions, application sharing, IM history, etc., can also be stored in Exchange Online, but most call detail records are temporarily stored on call detail record (CDR) servers.</span></span> <span data-ttu-id="95f31-145">不对每个租户对内容进行分区, 但通过 RBAC 强制实施了多租户。</span><span class="sxs-lookup"><span data-stu-id="95f31-145">Content is not partitioned per tenant, but multi-tenancy is enforced through RBAC.</span></span>

## <a name="sharepoint-online"></a><span data-ttu-id="95f31-146">SharePoint Online</span><span class="sxs-lookup"><span data-stu-id="95f31-146">SharePoint Online</span></span>

<span data-ttu-id="95f31-147">SharePoint Online 具有几种独立的机制, 可提供数据隔离。</span><span class="sxs-lookup"><span data-stu-id="95f31-147">SharePoint Online has several independent mechanisms that provide data isolation.</span></span> <span data-ttu-id="95f31-148">它将对象存储为应用程序数据库中的抽象代码。</span><span class="sxs-lookup"><span data-stu-id="95f31-148">It stores objects as abstracted code within application databases.</span></span> <span data-ttu-id="95f31-149">例如, 当用户将文件上传到 SharePoint Online 时, 文件将被反汇编, 转换为应用程序代码, 并存储在多个数据库中的多个表中。</span><span class="sxs-lookup"><span data-stu-id="95f31-149">For example, when a user uploads a file to SharePoint Online, the file is disassembled, translated into application code, and stored in multiple tables across multiple databases.</span></span>

<span data-ttu-id="95f31-150">如果用户可以直接访问包含数据的存储, 则不会将内容 interpretable 到 SharePoint Online 之外的人或任何系统。</span><span class="sxs-lookup"><span data-stu-id="95f31-150">If a user could gain direct access to the storage containing the data, the content is not interpretable to a human or any system other than SharePoint Online.</span></span> <span data-ttu-id="95f31-151">这些机制包括安全访问控制和属性。</span><span class="sxs-lookup"><span data-stu-id="95f31-151">These mechanisms include security access control and properties.</span></span> <span data-ttu-id="95f31-152">所有 SharePoint Online 资源均由授权代码和 RBAC 策略 (包括租赁中的) 进行保护。</span><span class="sxs-lookup"><span data-stu-id="95f31-152">All SharePoint Online resources are secured by the authorization code and RBAC policy, including within a tenancy.</span></span> <span data-ttu-id="95f31-153">保护资源的访问控制列表 (ACL) 包含在租户级别进行身份验证的标识。</span><span class="sxs-lookup"><span data-stu-id="95f31-153">The access control list (ACL) that secures a resource contains an identity authenticated at the tenant level.</span></span> <span data-ttu-id="95f31-154">租户的 SharePoint Online 数据仅限于由租户的身份验证提供程序身份验证的标识。</span><span class="sxs-lookup"><span data-stu-id="95f31-154">SharePoint Online data for a tenant is limited to identities authenticated by the authentication provider for the tenant.</span></span>

<span data-ttu-id="95f31-155">除了 acl 之外, 指定身份验证提供程序 (即租户特定的 Azure Active Directory) 的租户级别属性只写入一次, 并且在设置后不能更改。</span><span class="sxs-lookup"><span data-stu-id="95f31-155">In addition to the ACLs, a tenant level property that specifies the authentication provider (which is the tenant-specific Azure Active Directory), is written once and cannot be changed once set.</span></span> <span data-ttu-id="95f31-156">为租户设置身份验证提供程序租户属性后, 将无法使用公开给租户的任何 api 对其进行更改。</span><span class="sxs-lookup"><span data-stu-id="95f31-156">Once the authentication provider tenant property has been set for a tenant, it cannot be changed using any APIs exposed to a tenant.</span></span>

<span data-ttu-id="95f31-157">每个租户都使用唯一的*SubscriptionId* 。</span><span class="sxs-lookup"><span data-stu-id="95f31-157">A unique *SubscriptionId* is used for each tenant.</span></span> <span data-ttu-id="95f31-158">所有客户网站均由租户拥有, 并向其分配了对租户唯一的*订阅*。</span><span class="sxs-lookup"><span data-stu-id="95f31-158">All customer sites are owned by a tenant and assigned a *SubscriptionId* unique to the tenant.</span></span> <span data-ttu-id="95f31-159">网站上的*SubscriptionId*属性只写入一次, 并且是永久的。</span><span class="sxs-lookup"><span data-stu-id="95f31-159">The *SubscriptionId* property on a site is written once and is permanent.</span></span> <span data-ttu-id="95f31-160">一旦分配给租户, 便无法将网站移至其他租户。</span><span class="sxs-lookup"><span data-stu-id="95f31-160">Once assigned to a tenant, a site cannot be moved to a different tenant.</span></span> <span data-ttu-id="95f31-161">*SubscriptionId*是用于为身份验证提供程序创建安全作用域并与租户关联的密钥。</span><span class="sxs-lookup"><span data-stu-id="95f31-161">The *SubscriptionId* is the key used to create the security scope for the authentication provider and is tied to the tenant.</span></span>

<span data-ttu-id="95f31-162">SharePoint Online 使用 SQL Server 和 Azure 存储来存储内容元数据。</span><span class="sxs-lookup"><span data-stu-id="95f31-162">SharePoint Online uses SQL Server and Azure Storage for content metadata storage.</span></span> <span data-ttu-id="95f31-163">内容存储的分区键是在 SQL 中*SiteId* 。</span><span class="sxs-lookup"><span data-stu-id="95f31-163">The partition key for the content store is *SiteId* in SQL.</span></span> <span data-ttu-id="95f31-164">运行 SQL 查询时, SharePoint Online 将使用验证为租户级别*SubscriptionId*检查的一部分的*SiteId* 。</span><span class="sxs-lookup"><span data-stu-id="95f31-164">When running a SQL query, SharePoint Online uses a *SiteId* verified as part of a tenant-level *SubscriptionId* check.</span></span>

<span data-ttu-id="95f31-165">SharePoint Online 将加密文件内容存储在 Microsoft Azure blob 中。</span><span class="sxs-lookup"><span data-stu-id="95f31-165">SharePoint Online stores encrypted file content in Microsoft Azure blobs.</span></span> <span data-ttu-id="95f31-166">每个 SharePoint Online 场都有自己的 Microsoft Azure 帐户, 保存在 Azure 中的所有 blob 都使用存储在 SQL 内容存储中的密钥进行单独加密。</span><span class="sxs-lookup"><span data-stu-id="95f31-166">Each SharePoint Online farm has its own Microsoft Azure account and all the blobs saved in Azure are encrypted individually with a key stored in the SQL content store.</span></span> <span data-ttu-id="95f31-167">加密密钥受授权层在代码中保护, 且不会直接向最终用户公开。</span><span class="sxs-lookup"><span data-stu-id="95f31-167">The encryption key protected in code by the authorization layer and not exposed directly to the end user.</span></span> <span data-ttu-id="95f31-168">SharePoint Online 具有实时监控, 可在 HTTP 请求读取或写入多个租户的数据时进行检测。</span><span class="sxs-lookup"><span data-stu-id="95f31-168">SharePoint Online has real-time monitoring to detect when an HTTP request reads or writes data for more than one tenant.</span></span> <span data-ttu-id="95f31-169">将针对访问的资源的*SubscriptionId*跟踪请求标识*SubscriptionId* 。</span><span class="sxs-lookup"><span data-stu-id="95f31-169">The request identity *SubscriptionId* is tracked against the *SubscriptionId* of the accessed resource.</span></span> <span data-ttu-id="95f31-170">最终用户永远不应发生访问多个租户的资源的请求。</span><span class="sxs-lookup"><span data-stu-id="95f31-170">Requests to access resources of more than one tenant should never happen by end users.</span></span> <span data-ttu-id="95f31-171">多租户环境中的服务请求是唯一的例外。</span><span class="sxs-lookup"><span data-stu-id="95f31-171">Service requests in a multi-tenant environment are the only exception.</span></span> <span data-ttu-id="95f31-172">例如, 搜索爬网程序一次性提取整个数据库的内容更改。</span><span class="sxs-lookup"><span data-stu-id="95f31-172">For example, the search crawler pulls content changes for an entire database all at once.</span></span> <span data-ttu-id="95f31-173">这通常涉及在单个服务请求中查询多个租户的网站, 这是出于提高效率的原因而完成的。</span><span class="sxs-lookup"><span data-stu-id="95f31-173">This usually involves querying sites of more than one tenant in a single service request, which is done for efficiency reasons.</span></span>
