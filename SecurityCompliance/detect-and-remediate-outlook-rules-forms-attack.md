---
title: 检测和修正 Office 365 中的 Outlook 规则和自定义窗体注入攻击
ms.author: chrfox
author: chrfox
manager: laurawi
ms.date: 04/23/2018
ms.audience: ITPro
ms.topic: article
ms.collection:
- o365_security_incident_response
- M365-security-compliance
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
description: 了解如何识别和修正 Office 365 中的 Outlook 规则和自定义窗体注入攻击
ms.openlocfilehash: 59d45e50e15e3709c8a041ead59b8cc6e2a38306
ms.sourcegitcommit: 8657e003ab1ff49113f222d1ee8400eff174cb54
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 03/16/2019
ms.locfileid: "30656058"
---
# <a name="detect-and-remediate-outlook-rules-and-custom-forms-injections-attacks-in-office-365"></a><span data-ttu-id="59d3f-103">在 Office 365 中检测并修正 Outlook 规则和自定义窗体注入攻击</span><span class="sxs-lookup"><span data-stu-id="59d3f-103">Detect and Remediate Outlook Rules and Custom Forms Injections Attacks in Office 365</span></span>

<span data-ttu-id="59d3f-104">**摘要**了解如何识别和修正 Office 365 中的 Outlook 规则和自定义窗体注入攻击。</span><span class="sxs-lookup"><span data-stu-id="59d3f-104">**Summary** Learn how to recognize and remediate the Outlook rules and custom Forms injections attacks in Office 365.</span></span>

## <a name="what-is-the-outlook-rules-and-custom-forms-injection-attack"></a><span data-ttu-id="59d3f-105">Outlook 规则和自定义窗体注入攻击是什么？</span><span class="sxs-lookup"><span data-stu-id="59d3f-105">What is the Outlook Rules and Custom Forms injection attack?</span></span>
<span data-ttu-id="59d3f-106">在攻击者破坏了租赁中的帐户并在中进行了获取之后, 将尝试并建立一种在发现和删除这些帐户后将其保留或返回的方法。</span><span class="sxs-lookup"><span data-stu-id="59d3f-106">After an attacker has breached an account in your tenancy and gets in, they're are going to try and establish a way to stay in or a way to get back in after they are discovered and removed.</span></span> <span data-ttu-id="59d3f-107">这称为建立持久性机制。</span><span class="sxs-lookup"><span data-stu-id="59d3f-107">This is called establishing a persistence mechanism.</span></span> <span data-ttu-id="59d3f-108">可以通过以下两种方式来执行此操作: 利用 outlook 规则或将自定义窗体插入 outlook。</span><span class="sxs-lookup"><span data-stu-id="59d3f-108">Two ways that they can do this are by exploiting Outlook rules or by injecting custom forms into Outlook.</span></span>
<span data-ttu-id="59d3f-109">在这两种情况下, 规则或表单都将从云服务同步到桌面客户端, 因此完整的格式和重新安装客户端软件不会消除注入机制。</span><span class="sxs-lookup"><span data-stu-id="59d3f-109">In both cases, the rule or form is synced from the cloud service down to the desktop client, so a full format and re-install of the client software doesn't eliminate the injection mechanism.</span></span> <span data-ttu-id="59d3f-110">这是因为当 Outlook 客户端软件重新连接到云中的邮箱时, 它将从云中重新下载规则和表单。</span><span class="sxs-lookup"><span data-stu-id="59d3f-110">This is because when the Outlook client software reconnects to the mailbox in the cloud it will re-download the rules and forms from the cloud.</span></span> <span data-ttu-id="59d3f-111">规则和表单准备就绪后, 攻击者将使用它们执行远程或自定义代码, 通常是在本地计算机上安装恶意软件。</span><span class="sxs-lookup"><span data-stu-id="59d3f-111">Once the rules and forms are in place, the attacker uses them to execute remote or custom code, usually to install malware on the local machine.</span></span> <span data-ttu-id="59d3f-112">恶意软件然后重新盗取凭据或执行其他违法活动。</span><span class="sxs-lookup"><span data-stu-id="59d3f-112">The malware then re-steals credentials or performs other illicit activity.</span></span> <span data-ttu-id="59d3f-113">好消息是, 如果你将客户端修补到最新版本, 则不会因当前 Outlook 客户端默认阻止这两种机制而受到威胁。</span><span class="sxs-lookup"><span data-stu-id="59d3f-113">The good news here is that if you keep your clients patched to the latest version, you are not vulnerable to the threat as current Outlook client defaults block both mechanisms.</span></span> 

<span data-ttu-id="59d3f-114">攻击通常遵循以下模式:</span><span class="sxs-lookup"><span data-stu-id="59d3f-114">The attacks typically follow these patterns:</span></span>

<span data-ttu-id="59d3f-115">规则利用</span><span class="sxs-lookup"><span data-stu-id="59d3f-115">The Rules Exploit</span></span>
1. <span data-ttu-id="59d3f-116">攻击者盗取某个用户的用户名和密码。</span><span class="sxs-lookup"><span data-stu-id="59d3f-116">The attacker steals the username and password of one of your users.</span></span>
2. <span data-ttu-id="59d3f-117">然后, 攻击者登录到该用户的 Exchange 邮箱。</span><span class="sxs-lookup"><span data-stu-id="59d3f-117">The attacker then signs in to that users Exchange mailbox.</span></span> <span data-ttu-id="59d3f-118">邮箱可以位于 exchange online 中, 也可以位于本地 exchange 中。</span><span class="sxs-lookup"><span data-stu-id="59d3f-118">The mailbox can either be in Exchange online or in Exchange on-premises.</span></span>
3. <span data-ttu-id="59d3f-119">然后, 攻击者在邮箱收到符合规则条件的电子邮件时触发的邮箱中创建转发规则。</span><span class="sxs-lookup"><span data-stu-id="59d3f-119">The attacker then creates a forwarding rule in the mailbox that is triggered when the mailbox receives an email that matches the criteria of the rule.</span></span> <span data-ttu-id="59d3f-120">规则的条件和触发器电子邮件的内容为彼此进行了自适应。</span><span class="sxs-lookup"><span data-stu-id="59d3f-120">The criteria of rule and the contents of the trigger email are tailor-made for each other.</span></span>
4. <span data-ttu-id="59d3f-121">攻击者将触发器电子邮件发送到正常使用其邮箱的用户。</span><span class="sxs-lookup"><span data-stu-id="59d3f-121">The attacker sends the trigger email to the user who is using their mailbox normally.</span></span>
5. <span data-ttu-id="59d3f-122">收到电子邮件时, 将触发该规则。</span><span class="sxs-lookup"><span data-stu-id="59d3f-122">When the email is received, the rule is triggered.</span></span> <span data-ttu-id="59d3f-123">通常情况下, 该规则的操作是在远程 (WebDAV) 服务器上启动应用程序。</span><span class="sxs-lookup"><span data-stu-id="59d3f-123">The action of the rule is usually to launch an application on a remote (WebDAV) server.</span></span>
6. <span data-ttu-id="59d3f-124">应用程序通常会在用户的计算机上本地安装恶意软件, 如[Powershell Empire](https://www.powershellempire.com/)。</span><span class="sxs-lookup"><span data-stu-id="59d3f-124">The application typically installs malware, such as [Powershell Empire](https://www.powershellempire.com/), locally on the user’s machine.</span></span>
7. <span data-ttu-id="59d3f-125">恶意软件允许攻击者重新盗取用户的用户名和密码或本地计算机中的其他凭据, 并执行其他恶意活动。</span><span class="sxs-lookup"><span data-stu-id="59d3f-125">The malware allows the attacker to re-steal the user’s username and password or other credentials from local machine and perform other malicious activities.</span></span>

<span data-ttu-id="59d3f-126">表单利用</span><span class="sxs-lookup"><span data-stu-id="59d3f-126">The Forms Exploit</span></span>
1. <span data-ttu-id="59d3f-127">攻击者盗取某个用户的用户名和密码。</span><span class="sxs-lookup"><span data-stu-id="59d3f-127">The attacker steals the username and password of one of your users.</span></span>
2. <span data-ttu-id="59d3f-128">然后, 攻击者登录到该用户的 Exchange 邮箱。</span><span class="sxs-lookup"><span data-stu-id="59d3f-128">The attacker then sign in to that users Exchange mailbox.</span></span> <span data-ttu-id="59d3f-129">邮箱可以位于 exchange online 中, 也可以位于本地 exchange 中。</span><span class="sxs-lookup"><span data-stu-id="59d3f-129">The mailbox can either be in Exchange online or in Exchange on-premises.</span></span>
3. <span data-ttu-id="59d3f-130">然后, 攻击者创建一个自定义邮件表单模板, 并将其插入到用户的邮箱中。</span><span class="sxs-lookup"><span data-stu-id="59d3f-130">The attacker then creates a custom mail form template and inserts it into the user’s mailbox.</span></span>  <span data-ttu-id="59d3f-131">当邮箱收到需要邮箱加载自定义表单的电子邮件时, 将触发自定义表单。</span><span class="sxs-lookup"><span data-stu-id="59d3f-131">The custom form is triggered when the mailbox receives an email that requires the mailbox to load the custom form.</span></span> <span data-ttu-id="59d3f-132">自定义窗体和电子邮件的格式是彼此进行量身定制的。</span><span class="sxs-lookup"><span data-stu-id="59d3f-132">The custom form and the format of email are tailor-made for each other.</span></span>
4. <span data-ttu-id="59d3f-133">攻击者将触发器电子邮件发送给用户, 该用户将正常使用其邮箱。</span><span class="sxs-lookup"><span data-stu-id="59d3f-133">The attacker sends the trigger email to the user, who is using their mailbox normally.</span></span>
5. <span data-ttu-id="59d3f-134">收到电子邮件时, 将加载表单。</span><span class="sxs-lookup"><span data-stu-id="59d3f-134">When the email is received, the form is loaded.</span></span> <span data-ttu-id="59d3f-135">表单启动远程 (WebDAV) 服务器上的应用程序。</span><span class="sxs-lookup"><span data-stu-id="59d3f-135">The form launches an application on a remote (WebDAV) server.</span></span>
6. <span data-ttu-id="59d3f-136">应用程序通常会在用户的计算机上本地安装恶意软件, 如[Powershell Empire](https://www.powershellempire.com/)。</span><span class="sxs-lookup"><span data-stu-id="59d3f-136">The application typically installs malware, such as [Powershell Empire](https://www.powershellempire.com/), locally on the user’s machine.</span></span>
7. <span data-ttu-id="59d3f-137">恶意软件允许攻击者重新盗取用户的用户名和密码或本地计算机中的其他凭据, 并执行其他恶意活动。</span><span class="sxs-lookup"><span data-stu-id="59d3f-137">The malware allows the attacker to re-steal the user’s username and password or other credentials from local machine and perform other malicious activities.</span></span>


## <a name="what-a-rules-and-custom-forms-injection-attack-might-look-like-office-365"></a><span data-ttu-id="59d3f-138">哪些规则和自定义窗体注入攻击可能看起来像 Office 365？</span><span class="sxs-lookup"><span data-stu-id="59d3f-138">What a Rules and Custom Forms Injection attack might look like Office 365?</span></span>

<span data-ttu-id="59d3f-139">这些永久性机制不太可能被用户注意到, 有时在某些情况下可能对它们不可见。</span><span class="sxs-lookup"><span data-stu-id="59d3f-139">These persistence mechanisms are unlikely to be noticed by your users and may in some cases even be invisible to them.</span></span>  <span data-ttu-id="59d3f-140">本文将介绍如何查找以下列出的任何七个符号 (泄露指示器) 中的任何一个。</span><span class="sxs-lookup"><span data-stu-id="59d3f-140">This article tells you how to look for any of the seven signs (Indicators of Compromise) listed below.</span></span> <span data-ttu-id="59d3f-141">如果您发现其中任何一个, 则需要采取补救措施。</span><span class="sxs-lookup"><span data-stu-id="59d3f-141">If you find any of these, you need to take remediation steps.</span></span>

- <span data-ttu-id="59d3f-142">规则泄露的指示器</span><span class="sxs-lookup"><span data-stu-id="59d3f-142">Indicators of the Rules compromise</span></span>
    - <span data-ttu-id="59d3f-143">规则操作是启动应用程序。</span><span class="sxs-lookup"><span data-stu-id="59d3f-143">Rule Action is to start an application.</span></span>
    - <span data-ttu-id="59d3f-144">Rule 引用 EXE、ZIP 或 URL。</span><span class="sxs-lookup"><span data-stu-id="59d3f-144">Rule References an EXE, ZIP, or URL.</span></span>
    - <span data-ttu-id="59d3f-145">在本地计算机上, 查找来自 Outlook PID 的新进程启动。</span><span class="sxs-lookup"><span data-stu-id="59d3f-145">On the local machine, look for new process starts that originate from the Outlook PID.</span></span>
- <span data-ttu-id="59d3f-146">自定义窗体的指示器受到危害</span><span class="sxs-lookup"><span data-stu-id="59d3f-146">Indicators of the Custom forms compromise</span></span> 
    - <span data-ttu-id="59d3f-147">自定义表单显示另存为自己的邮件类。</span><span class="sxs-lookup"><span data-stu-id="59d3f-147">Custom form present saved as their own message class.</span></span>
    - <span data-ttu-id="59d3f-148">邮件类包含可执行代码。</span><span class="sxs-lookup"><span data-stu-id="59d3f-148">Message class contains executable code.</span></span>
    - <span data-ttu-id="59d3f-149">通常存储在 "个人表单库" 或 "收件箱" 文件夹中。</span><span class="sxs-lookup"><span data-stu-id="59d3f-149">Usually stored in Personal Forms Library or Inbox folders.</span></span>
    - <span data-ttu-id="59d3f-150">表单名为 IPM。便笺.[custom name]。</span><span class="sxs-lookup"><span data-stu-id="59d3f-150">Form is named IPM.Note.[custom name].</span></span>

## <a name="steps-for-finding-signs-of-this-attack-and-confirming-it"></a><span data-ttu-id="59d3f-151">查找此攻击的迹象和确认此攻击的步骤</span><span class="sxs-lookup"><span data-stu-id="59d3f-151">Steps for finding signs of this attack and confirming it</span></span>
<span data-ttu-id="59d3f-152">您可以使用这两种方法中的任何一种来确认攻击。</span><span class="sxs-lookup"><span data-stu-id="59d3f-152">You can use either of these two methods to confirm the attack.</span></span>
- <span data-ttu-id="59d3f-153">使用 Outlook 客户端手动检查每个邮箱的规则和窗体。</span><span class="sxs-lookup"><span data-stu-id="59d3f-153">Manually examine the rules and forms for each mailbox using the Outlook client.</span></span>  <span data-ttu-id="59d3f-154">这种方法是彻底的, 但如果您有多个用户要进行检查, 则一次只能检查邮箱用户。</span><span class="sxs-lookup"><span data-stu-id="59d3f-154">This method is thorough, but you can only check mailbox user at a time which can be very time consuming if you have many users to check.</span></span>  <span data-ttu-id="59d3f-155">此外, 它还会导致破坏正在运行检查的计算机。</span><span class="sxs-lookup"><span data-stu-id="59d3f-155">It can also result in a breach of the computer that you are running the check from.</span></span>
- <span data-ttu-id="59d3f-156">使用[Get-AllTenantRulesAndForms](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell 脚本自动为租户中的所有用户转储所有邮件转发规则和自定义窗体。</span><span class="sxs-lookup"><span data-stu-id="59d3f-156">Use the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script to automatically dump all the mail forwarding rules and custom forms for all the users in your tenancy.</span></span> <span data-ttu-id="59d3f-157">这是最快、最安全的方法, 最小开销。</span><span class="sxs-lookup"><span data-stu-id="59d3f-157">This is the fastest and safest method with the least amount of overhead.</span></span>


### <a name="confirm-the-rules-attack-using-the-outlook-client"></a><span data-ttu-id="59d3f-158">使用 Outlook 客户端确认规则攻击</span><span class="sxs-lookup"><span data-stu-id="59d3f-158">Confirm the Rules Attack Using the Outlook client</span></span>
1. <span data-ttu-id="59d3f-159">以用户的形式打开用户 Outlook 客户端。</span><span class="sxs-lookup"><span data-stu-id="59d3f-159">Open the users Outlook client as the user.</span></span>  <span data-ttu-id="59d3f-160">用户可能需要您的帮助来检查其邮箱上的规则。</span><span class="sxs-lookup"><span data-stu-id="59d3f-160">The user may need your help in examining the rules on their mailbox.</span></span>
2. <span data-ttu-id="59d3f-161">有关如何在2007、2010或2013版本的 Outlook 中打开 rules 接口的过程, 请参阅[使用规则文章管理电子邮件](https://support.office.com/article/manage-email-messages-by-using-rules-c24f5dea-9465-4df4-ad17-a50704d66c59#ID0EAABAAA=2010)。</span><span class="sxs-lookup"><span data-stu-id="59d3f-161">Refer to [Manage email messages by using rules](https://support.office.com/article/manage-email-messages-by-using-rules-c24f5dea-9465-4df4-ad17-a50704d66c59#ID0EAABAAA=2010) article for the procedures on how to open the rules interface in either the 2007, 2010 or 2013 versions of Outlook.</span></span>
3. <span data-ttu-id="59d3f-162">查找用户未创建的规则或具有可疑名称的任何意外规则或规则。</span><span class="sxs-lookup"><span data-stu-id="59d3f-162">Look for rules that the user did not create, or any unexpected rules or rules with suspicious names.</span></span>
4. <span data-ttu-id="59d3f-163">在规则说明中查找启动和应用程序或引用的规则操作的规则说明。EXE。ZIP 文件或启动 URL。</span><span class="sxs-lookup"><span data-stu-id="59d3f-163">Look in the rule description for rule actions that start and application or refer to an .EXE, .ZIP file or to launching a URL.</span></span>
5. <span data-ttu-id="59d3f-164">查找所有使用 Outlook 进程 ID 开始的新进程。</span><span class="sxs-lookup"><span data-stu-id="59d3f-164">Look for any new processes that start using the Outlook process ID.</span></span>  <span data-ttu-id="59d3f-165">请参阅[查找进程 ID](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id)。</span><span class="sxs-lookup"><span data-stu-id="59d3f-165">Refer to [Find the Process ID](https://docs.microsoft.com/windows-hardware/drivers/debugger/finding-the-process-id).</span></span>

### <a name="steps-to-confirm-the-forms-attack-using-the-outlook-client"></a><span data-ttu-id="59d3f-166">使用 Outlook 客户端确认表单攻击的步骤</span><span class="sxs-lookup"><span data-stu-id="59d3f-166">Steps to confirm the Forms attack using the Outlook client</span></span>
1. <span data-ttu-id="59d3f-167">以用户的形式打开用户 Outlook 客户端。</span><span class="sxs-lookup"><span data-stu-id="59d3f-167">Open the user Outlook client as the user.</span></span>
2. <span data-ttu-id="59d3f-168">按照中的步骤, 为用户版本的 Outlook[显示 "开发工具" 选项卡](https://support.office.com/article/show-the-developer-tab-e1192344-5e56-4d45-931b-e5fd9bea2d45)。</span><span class="sxs-lookup"><span data-stu-id="59d3f-168">Follow the steps in, [Show the Developer tab](https://support.office.com/article/show-the-developer-tab-e1192344-5e56-4d45-931b-e5fd9bea2d45) for the users version of Outlook.</span></span>
3. <span data-ttu-id="59d3f-169">在 Outlook 中打开 "现在可见的开发工具" 选项卡, 然后单击 "**设计窗体**"。</span><span class="sxs-lookup"><span data-stu-id="59d3f-169">Open the now visible developer tab in Outlook and click **design a form**.</span></span>
4. <span data-ttu-id="59d3f-170">从 "**查找范围**" 列表中选择 "**收件箱**"。</span><span class="sxs-lookup"><span data-stu-id="59d3f-170">Select the **Inbox** from the **Look In** list.</span></span> <span data-ttu-id="59d3f-171">查找任何自定义窗体。</span><span class="sxs-lookup"><span data-stu-id="59d3f-171">Look for any custom forms.</span></span>  <span data-ttu-id="59d3f-172">自定义窗体非常罕见, 如果你有任何自定义表单, 则需要更深入的了解。</span><span class="sxs-lookup"><span data-stu-id="59d3f-172">Custom forms are rare enough that if you have any custom forms at all, it is worth a deeper look.</span></span>
5. <span data-ttu-id="59d3f-173">调查任何自定义窗体, 尤其是那些标记为隐藏的窗体。</span><span class="sxs-lookup"><span data-stu-id="59d3f-173">Investigate any custom forms, especially those marked as hidden.</span></span>
6. <span data-ttu-id="59d3f-174">打开任何自定义窗体, 然后在**窗体**组中单击 "**查看代码**" 以查看加载窗体时的运行内容。</span><span class="sxs-lookup"><span data-stu-id="59d3f-174">Open any custom forms and in the **Form** group click **View Code** to see what runs when the form is loaded.</span></span>

### <a name="steps-to-confirm-the-rules-and-forms-attack-using-powershell"></a><span data-ttu-id="59d3f-175">使用 PowerShell 确认规则和表单攻击的步骤</span><span class="sxs-lookup"><span data-stu-id="59d3f-175">Steps to confirm the Rules and Forms attack using PowerShell</span></span>
<span data-ttu-id="59d3f-176">验证规则或自定义表单攻击的最简单方法是运行[Get-AllTenantRulesAndForms](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell 脚本。</span><span class="sxs-lookup"><span data-stu-id="59d3f-176">The simplest way to verify a rules or custom forms attack is to run the [Get-AllTenantRulesAndForms.ps1](https://github.com/OfficeDev/O365-InvestigationTooling/blob/master/Get-AllTenantRulesAndForms.ps1) PowerShell script.</span></span>  <span data-ttu-id="59d3f-177">此脚本将连接到租户中的每个邮箱, 并将所有规则和窗体转储为两个 .csv 文件。</span><span class="sxs-lookup"><span data-stu-id="59d3f-177">This script connects to every mailbox in your tenant and dumps all the rules and forms into two .csv files.</span></span>

#### <a name="pre-requisites"></a><span data-ttu-id="59d3f-178">先决条件</span><span class="sxs-lookup"><span data-stu-id="59d3f-178">Pre-requisites</span></span>
<span data-ttu-id="59d3f-179">由于脚本将连接到租赁中的每个邮箱, 您需要具有全局管理员权限才能运行该脚本, 以读取规则和表单。</span><span class="sxs-lookup"><span data-stu-id="59d3f-179">You will need to have a global administrator rights to run the script because the script connects to every mailbox in the tenancy to read the rules and forms.</span></span>

1. <span data-ttu-id="59d3f-180">登录到您将使用本地管理员权限运行脚本的计算机。</span><span class="sxs-lookup"><span data-stu-id="59d3f-180">Sign in to the machine that you will run the script from with local administrator rights.</span></span>
2. <span data-ttu-id="59d3f-181">将 Get-AllTenantRulesAndForms 脚本从 GitHub 下载或复制到将从中运行它的文件夹中。</span><span class="sxs-lookup"><span data-stu-id="59d3f-181">Download or copy the Get-AllTenantRulesAndForms.ps1 script from GitHub to a folder from which you will run it.</span></span>  <span data-ttu-id="59d3f-182">该脚本将创建两个日期戳文件到此文件夹、MailboxFormsExport-yyyy-mm-dd 和 MailboxRulesExport-yyyy-mm-dd。</span><span class="sxs-lookup"><span data-stu-id="59d3f-182">The script will create two date stamped files to this folder, MailboxFormsExport-yyyy-mm-dd.csv, and MailboxRulesExport-yyyy-mm-dd.csv.</span></span>
3. <span data-ttu-id="59d3f-183">以管理员身份打开 PowerShell 实例, 并打开保存脚本的文件夹。</span><span class="sxs-lookup"><span data-stu-id="59d3f-183">Open a PowerShell instance as an administrator and open the folder you saved the script to.</span></span>
4. <span data-ttu-id="59d3f-184">按如下所示`.\Get-AllTenantRulesAndForms.ps1`运行此 PowerShell 命令行 .\Get-AllTenantRulesAndForms.ps1</span><span class="sxs-lookup"><span data-stu-id="59d3f-184">Run this PowerShell command line as follows `.\Get-AllTenantRulesAndForms.ps1`.\Get-AllTenantRulesAndForms.ps1</span></span>

#### <a name="interpreting-the-output"></a><span data-ttu-id="59d3f-185">解释输出</span><span class="sxs-lookup"><span data-stu-id="59d3f-185">Interpreting the output</span></span>

<span data-ttu-id="59d3f-186">MailboxRulesExport-*mm-dd*–检查包含应用程序或可执行文件的操作条件的规则 (每行一个)。</span><span class="sxs-lookup"><span data-stu-id="59d3f-186">MailboxRulesExport-*yyyy-mm-dd*.csv – examine the rules (one per row) for action conditions that include applications or executables.</span></span>
- <span data-ttu-id="59d3f-187">ActionType (列 A) –如果您看到值 "ID_ACTION_CUSTOM", 则该规则可能是恶意的。</span><span class="sxs-lookup"><span data-stu-id="59d3f-187">ActionType (column A) – if you see the value “ID_ACTION_CUSTOM”, the rule is likely malicious.</span></span>
- <span data-ttu-id="59d3f-188">IsPotentiallyMalicious (column D) –如果此值为 "TRUE", 则该规则可能是恶意的。</span><span class="sxs-lookup"><span data-stu-id="59d3f-188">IsPotentiallyMalicious (column D) – if this value is “TRUE”, the rule is likely malicious.</span></span>
- <span data-ttu-id="59d3f-189">ActionCommand (column G) –如果这列出了应用程序或任何带 .exe、.zip 扩展名的文件或引用了 URL 的条目, 则该规则可能是恶意的。</span><span class="sxs-lookup"><span data-stu-id="59d3f-189">ActionCommand (column G) – if this lists an application or any file with a .exe, .zip extension or an entry that refers to a URL, that is not supposed to be there, the rule is likely malicious.</span></span>

<span data-ttu-id="59d3f-190">MailboxFormsExport-*dd*.csv –通常情况下, 使用自定义窗体非常罕见。</span><span class="sxs-lookup"><span data-stu-id="59d3f-190">MailboxFormsExport-*yyyy-mm-dd*.csv – in general, the use of custom forms is very rare.</span></span>  <span data-ttu-id="59d3f-191">如果在此工作簿中找到任何类型, 则打开该用户的邮箱并检查表单本身。</span><span class="sxs-lookup"><span data-stu-id="59d3f-191">If you find any in this workbook, you open that user’s mailbox and examine the form itself.</span></span>  <span data-ttu-id="59d3f-192">如果您的组织没有有意将其放在那里, 则可能是恶意的。</span><span class="sxs-lookup"><span data-stu-id="59d3f-192">If your organization did not put it there intentionally, it is likely malicious.</span></span>



## <a name="how-to-stop-and-remediate-the-outlook-rules-and-forms-attack"></a><span data-ttu-id="59d3f-193">如何停止和修正 Outlook 规则和表单攻击</span><span class="sxs-lookup"><span data-stu-id="59d3f-193">How to stop and remediate the Outlook Rules and Forms attack</span></span>
<span data-ttu-id="59d3f-194">如果您发现上述任一攻击的任何证据, 补救措施就很简单, 只需从邮箱中删除该规则或表单即可。</span><span class="sxs-lookup"><span data-stu-id="59d3f-194">If you find any evidence of either of these attacks, remediation is simple, just delete the rule or form from the mailbox.</span></span> <span data-ttu-id="59d3f-195">您可以使用 Outlook 客户端或使用远程 PowerShell 删除规则。</span><span class="sxs-lookup"><span data-stu-id="59d3f-195">You can do this with the Outlook client or using remote PowerShell to remove rules.</span></span>

### <a name="using-outlook"></a><span data-ttu-id="59d3f-196">使用 Outlook</span><span class="sxs-lookup"><span data-stu-id="59d3f-196">Using Outlook</span></span>
1. <span data-ttu-id="59d3f-197">标识用户在 Outlook 中使用的所有设备。</span><span class="sxs-lookup"><span data-stu-id="59d3f-197">Identify all the devices that the user has used with Outlook.</span></span>  <span data-ttu-id="59d3f-198">所有这些人都需要清除潜在的恶意软件。</span><span class="sxs-lookup"><span data-stu-id="59d3f-198">They will all need to be cleaned of potential malware.</span></span>  <span data-ttu-id="59d3f-199">在清理所有设备之前, 不要允许用户登录并使用电子邮件。</span><span class="sxs-lookup"><span data-stu-id="59d3f-199">Do not allow the user to sign on and use email until all the devices are cleaned.</span></span>
2. <span data-ttu-id="59d3f-200">按照 "删除每个设备的[规则](https://support.office.com/article/Delete-a-rule-2F0E7139-F696-4422-8498-44846DB9067F)" 中的步骤操作。</span><span class="sxs-lookup"><span data-stu-id="59d3f-200">Follow the steps in [Delete a rule](https://support.office.com/article/Delete-a-rule-2F0E7139-F696-4422-8498-44846DB9067F) for each device.</span></span>
3. <span data-ttu-id="59d3f-201">如果您不确定是否存在其他恶意软件, 可以在设备上格式化并重新安装所有软件。</span><span class="sxs-lookup"><span data-stu-id="59d3f-201">If you are unsure about the presence of other malware, you can format and re-install all the software on the device.</span></span>  <span data-ttu-id="59d3f-202">对于移动设备, 您可以按照制造商的步骤操作, 将设备重置为出厂映像。</span><span class="sxs-lookup"><span data-stu-id="59d3f-202">For mobile devices you can follow the manufacturers steps to reset the device to the factory image.</span></span>
4. <span data-ttu-id="59d3f-203">安装最新版本的 Outlook。</span><span class="sxs-lookup"><span data-stu-id="59d3f-203">Install the most up-to-date versions of Outlook.</span></span>  <span data-ttu-id="59d3f-204">请注意, 默认情况下, 当前版本的 Outlook 阻止这两种攻击类型。</span><span class="sxs-lookup"><span data-stu-id="59d3f-204">Remember that the current version of Outlook blocks both types of this attack by default.</span></span>
5. <span data-ttu-id="59d3f-205">删除邮箱的所有脱机副本后, 重置用户的密码 (使用高质量的密码), 并按照[Setup 多重身份验证](https://support.office.com/article/Set-up-multi-factor-authentication-for-Office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6)(如果尚未启用 MFA) 中的步骤操作。</span><span class="sxs-lookup"><span data-stu-id="59d3f-205">Once all offline copies of the mailbox have been removed, reset the user's password (use a high-quality one) and follow the steps in [Setup multi-factor authentication for Office 365 users](https://support.office.com/article/Set-up-multi-factor-authentication-for-Office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6) if MFA has not already been enabled.</span></span> <span data-ttu-id="59d3f-206">这可确保用户的凭据不会通过其他方式 (如网络钓鱼或密码重用) 公开。</span><span class="sxs-lookup"><span data-stu-id="59d3f-206">This ensures that the user's credentials are not exposed via other means (such as phishing or password re-use).</span></span>

### <a name="using-powershell"></a><span data-ttu-id="59d3f-207">使用 PowerShell</span><span class="sxs-lookup"><span data-stu-id="59d3f-207">Using PowerShell</span></span>
<span data-ttu-id="59d3f-208">有两个可用于删除或禁用危险规则的远程 PowerShell cmdlet。</span><span class="sxs-lookup"><span data-stu-id="59d3f-208">There are two remote PowerShell cmdlets you can use to remove or disable dangerous rules.</span></span> <span data-ttu-id="59d3f-209">只需按照步骤操作即可。</span><span class="sxs-lookup"><span data-stu-id="59d3f-209">Just follow the steps.</span></span>
 
<span data-ttu-id="59d3f-210">Exchange 服务器上的邮箱的步骤</span><span class="sxs-lookup"><span data-stu-id="59d3f-210">Steps for mailboxes that are on an Exchange server</span></span>

1. <span data-ttu-id="59d3f-211">使用远程 PowerShell 连接到 Exchange 服务器。</span><span class="sxs-lookup"><span data-stu-id="59d3f-211">Connect to the Exchange server using remote PowerShell.</span></span> <span data-ttu-id="59d3f-212">按照[使用远程 PowerShell 连接到 Exchange 服务器](https://docs.microsoft.com/powershell/exchange/exchange-server/connect-to-exchange-servers-using-remote-powershell?view=exchange-ps)中的步骤操作。</span><span class="sxs-lookup"><span data-stu-id="59d3f-212">Follow the steps in [Connect to Exchange servers using remote PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-server/connect-to-exchange-servers-using-remote-powershell?view=exchange-ps).</span></span>
2. <span data-ttu-id="59d3f-213">如果要从邮箱中完全删除单个规则、多个规则或所有规则, 请使用 "[删除收件箱" 规则 cmdlet ](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps)-使用此项可从邮箱中完全删除一个、多个或所有规则。</span><span class="sxs-lookup"><span data-stu-id="59d3f-213">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-Inbox Rule cmdlet ](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps)- use this to completely remove one, multiple, or all rules from the mailbox.</span></span>
3. <span data-ttu-id="59d3f-214">如果要保留规则及其内容以进行进一步调查, 请使用[new-inboxrule cmdlet](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx)。</span><span class="sxs-lookup"><span data-stu-id="59d3f-214">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule cmdlet](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx).</span></span> 

<span data-ttu-id="59d3f-215">Exchange Online 中邮箱的步骤</span><span class="sxs-lookup"><span data-stu-id="59d3f-215">Steps for mailboxes in Exchange Online</span></span>
1. <span data-ttu-id="59d3f-216">按照 "[使用 PowerShell 连接到 Exchange Online](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell?view=exchange-ps)" 中的步骤操作。</span><span class="sxs-lookup"><span data-stu-id="59d3f-216">Follow the steps in [Connect to Exchange Online using PowerShell](https://docs.microsoft.com/powershell/exchange/exchange-online/connect-to-exchange-online-powershell/connect-to-exchange-online-powershell?view=exchange-ps).</span></span>
2.  <span data-ttu-id="59d3f-217">如果要完全删除单个规则、多个规则或来自一个邮箱的所有规则, 请使用 "[删除收件箱" 规则 cmdlet](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps)。</span><span class="sxs-lookup"><span data-stu-id="59d3f-217">If you want to completely remove a single rule, multiple rules, or all rules from a mailbox use the [Remove-Inbox Rule cmdlet](https://docs.microsoft.com/powershell/module/exchange/mailboxes/Remove-InboxRule?view=exchange-ps).</span></span>
3.  <span data-ttu-id="59d3f-218">如果要保留规则及其内容以进行进一步调查, 请使用[new-inboxrule cmdlet](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx)。</span><span class="sxs-lookup"><span data-stu-id="59d3f-218">If you want to retain the rule and its contents for further investigation use the [Disable-InboxRule cmdlet](https://technet.microsoft.com/en-us/library/dd298120(v=exchg.160).aspx).</span></span> 

## <a name="how-to-minimize-future-attacks"></a><span data-ttu-id="59d3f-219">如何最大限度地减少未来攻击</span><span class="sxs-lookup"><span data-stu-id="59d3f-219">How to minimize future attacks</span></span>

### <a name="first-protect-your-accounts"></a><span data-ttu-id="59d3f-220">首先: 保护你的帐户</span><span class="sxs-lookup"><span data-stu-id="59d3f-220">First: protect your accounts</span></span>

<span data-ttu-id="59d3f-221">只有攻击者在窃取或破坏用户的帐户后, 才会使用这些规则和表单攻击。</span><span class="sxs-lookup"><span data-stu-id="59d3f-221">The Rules and Forms exploits are only used by an attacker after they have stolen or breached one of your user’s accounts.</span></span> <span data-ttu-id="59d3f-222">因此, 阻止对组织使用这些漏洞的第一步是主动保护您的用户帐户。</span><span class="sxs-lookup"><span data-stu-id="59d3f-222">So, your first step to preventing the use of these exploits against your organization is to aggressively protect your user accounts.</span></span>  <span data-ttu-id="59d3f-223">帐户受到破坏的一些最常见的方法是通过网络钓鱼或[密码 spraying](http://www.dabcc.com/microsoft-defending-against-password-spray-attacks/)攻击。</span><span class="sxs-lookup"><span data-stu-id="59d3f-223">Some of the most common ways that accounts are breached are through phishing or [password spraying](http://www.dabcc.com/microsoft-defending-against-password-spray-attacks/) attacks.</span></span>



<span data-ttu-id="59d3f-224">保护用户帐户 (尤其是管理员帐户) 的最佳方法是为[Office 365 用户设置多重身份验证](https://support.office.com/article/set-up-multi-factor-authentication-for-office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6)。</span><span class="sxs-lookup"><span data-stu-id="59d3f-224">The best way to protect your user accounts, and especially your administrator accounts, is to [set up multi-factor authentication for Office 365 users](https://support.office.com/article/set-up-multi-factor-authentication-for-office-365-users-8f0454b2-f51a-4d9c-bcde-2c48e41621c6).</span></span>  <span data-ttu-id="59d3f-225">此外, 还应执行以下操作:</span><span class="sxs-lookup"><span data-stu-id="59d3f-225">You should also:</span></span>
<ol>
    <li><span data-ttu-id="59d3f-226">监视如何<a href="https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports">访问和使用</a>您的用户帐户。</span><span class="sxs-lookup"><span data-stu-id="59d3f-226">Monitor how your user accounts are <a href="https://docs.microsoft.com/azure/active-directory/active-directory-view-access-usage-reports">accessed and used</a>.</span></span> <span data-ttu-id="59d3f-227">您可能不会阻止最初的破坏, 但您将通过更快地进行检测来缩短危害的持续时间和影响。</span><span class="sxs-lookup"><span data-stu-id="59d3f-227">You may not prevent the initial breach, but you will shorten the duration and the impact of the breach by detecting it sooner.</span></span> <span data-ttu-id="59d3f-228">您可以使用以下内容: <a href="https://support.office.com/article/overview-of-office-365-cloud-app-security-81f0ee9a-9645-45ab-ba56-de9cbccab475">Office 365 云应用安全策略</a>来监视您的帐户并通知异常活动。</span><span class="sxs-lookup"><span data-stu-id="59d3f-228">You can use these: <a href="https://support.office.com/article/overview-of-office-365-cloud-app-security-81f0ee9a-9645-45ab-ba56-de9cbccab475"> Office 365 Cloud App Security policies</a> to monitor you accounts and alert on unusual activity.</span></span> 
        <ol type="a">
            <li><span data-ttu-id="59d3f-229"><b>多次失败的登录尝试</b>当用户在一个会话中执行多个失败的登录活动时, 此策略将配置为您的环境并触发警报, 这可能表示尝试受到破坏。</span><span class="sxs-lookup"><span data-stu-id="59d3f-229"><b>Multiple failed login attempts</b> This policy profiles your environment and triggers alerts when users perform multiple failed login activities in a single session with respect to the learned baseline, which could indicate an attempted breach.</span></span></li>
            <li><span data-ttu-id="59d3f-230"><b>无法旅行</b>-此策略配置您的环境, 并在从同一用户在两个位置之间的不同位置 (短于两个位置之间的预期旅行时间) 内检测到活动时触发警报。</span><span class="sxs-lookup"><span data-stu-id="59d3f-230"><b>Impossible travel</b> - This policy profiles your environment and triggers alerts when activities are detected from the same user in different locations within a time period that is shorter than the expected travel time between the two locations.</span></span> <span data-ttu-id="59d3f-231">这可能表示其他用户正在使用相同的凭据。</span><span class="sxs-lookup"><span data-stu-id="59d3f-231">This could indicate that a different user is using the same credentials.</span></span> <span data-ttu-id="59d3f-232">如果检测到此异常行为, 则可以在七天内学习新用户的活动模式的初始学习期。</span><span class="sxs-lookup"><span data-stu-id="59d3f-232">Detecting this anomalous behavior necessitates an initial learning period of seven days during which it learns a new user’s activity pattern.</span></span></li>
            <li><span data-ttu-id="59d3f-233"><b>异常模拟活动 (按用户)</b>-当用户在一个会话中执行多个模拟活动时, 此策略将对你的环境和触发警报进行分析, 这可能表示尝试了泄露。</span><span class="sxs-lookup"><span data-stu-id="59d3f-233"><b>Unusual impersonated activity (by user)</b> - This policy profiles your environment and triggers alerts when users perform multiple impersonated activities in a single session with respect to the baseline learned, which could indicate an attempted breach.</span></span></li>
        </ol>
    </li>
    <li><span data-ttu-id="59d3f-234">利用类似于<a href="https://securescore.office.com/">Office 365 安全分数</a>的工具来管理帐户安全配置和行为。</span><span class="sxs-lookup"><span data-stu-id="59d3f-234">Leverage a tool like the <a href="https://securescore.office.com/">Office 365 Secure Score</a> to manage account security configurations and behaviors.</span></span> 
    </li>
</ol> 

### <a name="second-keep-your-outlook-clients-current"></a><span data-ttu-id="59d3f-235">其次: 将 Outlook 客户端保持为最新</span><span class="sxs-lookup"><span data-stu-id="59d3f-235">Second: Keep your Outlook clients current</span></span>
<span data-ttu-id="59d3f-236">完全更新和修补的 Outlook 2013 版本, 2016 默认禁用 "启动应用程序" 规则/表单操作。</span><span class="sxs-lookup"><span data-stu-id="59d3f-236">Fully-updated and patched versions of Outlook 2013, and 2016 disable the “Start Application” rule/form action by default.</span></span>  <span data-ttu-id="59d3f-237">这将确保即使攻击者破坏了帐户, 规则和表单操作也将受到阻止。</span><span class="sxs-lookup"><span data-stu-id="59d3f-237">This will ensure that, even if an attacker breaches the account, the rule and form actions will be blocked.</span></span>  <span data-ttu-id="59d3f-238">您可以按照[安装 Office 更新](https://support.office.com/article/Install-Office-updates-2ab296f3-7f03-43a2-8e50-46de917611c5)中的步骤安装最新的更新和安全修补程序。</span><span class="sxs-lookup"><span data-stu-id="59d3f-238">You can install the latest updates and security patches by following the steps in [Install Office updates](https://support.office.com/article/Install-Office-updates-2ab296f3-7f03-43a2-8e50-46de917611c5).</span></span>

<span data-ttu-id="59d3f-239">下面是 Outlook 2013 和2016客户端的修补程序版本:</span><span class="sxs-lookup"><span data-stu-id="59d3f-239">Here are the patch versions for your Outlook 2013 and 2016 clients:</span></span>
- <span data-ttu-id="59d3f-240">Outlook 2013: 15.0.4937.1000 或更高版本</span><span class="sxs-lookup"><span data-stu-id="59d3f-240">Outlook 2013: 15.0.4937.1000 or greater</span></span>
- <span data-ttu-id="59d3f-241">Outlook 2016: 16.0.4534.1001 或更高版本</span><span class="sxs-lookup"><span data-stu-id="59d3f-241">Outlook 2016: 16.0.4534.1001 or greater</span></span>

<span data-ttu-id="59d3f-242">有关各个安全修补程序的详细信息, 请参阅:</span><span class="sxs-lookup"><span data-stu-id="59d3f-242">For more information on the individual security patches, see:</span></span>

- [<span data-ttu-id="59d3f-243">Outlook 2013 安全修补程序</span><span class="sxs-lookup"><span data-stu-id="59d3f-243">Outlook 2013 Security Patch</span></span>](https://support.microsoft.com/en-us/help/3191938) 
- [<span data-ttu-id="59d3f-244">Outlook 2016 安全修补程序</span><span class="sxs-lookup"><span data-stu-id="59d3f-244">Outlook 2016 Security Patch</span></span>](https://support.microsoft.com/en-us/help/3191883)

### <a name="third-monitor-your-outlook-clients"></a><span data-ttu-id="59d3f-245">第三个: 监视您的 Outlook 客户端</span><span class="sxs-lookup"><span data-stu-id="59d3f-245">Third: Monitor your Outlook clients</span></span>
<span data-ttu-id="59d3f-246">请注意, 即使安装了修补程序和更新, 攻击者也有可能更改本地计算机配置以重新启用 "启动应用程序" 行为。</span><span class="sxs-lookup"><span data-stu-id="59d3f-246">Note that even with the patches and updates installed, it is possible for an attacker to change the local machine configuration to re-enable the “Start Application” behavior.</span></span> <span data-ttu-id="59d3f-247">您可以使用[高级组策略管理](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/)在客户端上监视和强制实施本地计算机策略。</span><span class="sxs-lookup"><span data-stu-id="59d3f-247">You can use [Advanced Group Policy Management](https://docs.microsoft.com/microsoft-desktop-optimization-pack/agpm/) to monitor and enforce local machine policies on your clients.</span></span>  
<span data-ttu-id="59d3f-248">通过使用[如何使用 Windows 的64位版本查看系统注册表](https://support.microsoft.com/en-us/help/305097/how-to-view-the-system-registry-by-using-64-bit-versions-of-windows)中的信息, 可以查看是否已通过注册表中的替代重新启用了 "启动应用程序"。</span><span class="sxs-lookup"><span data-stu-id="59d3f-248">You can to see if “Start Application” has been re-enabled through an override in the registry by using the information in [How to view the system registry by using 64-bit versions of Windows](https://support.microsoft.com/en-us/help/305097/how-to-view-the-system-registry-by-using-64-bit-versions-of-windows).</span></span>  <span data-ttu-id="59d3f-249">检查以下子项:</span><span class="sxs-lookup"><span data-stu-id="59d3f-249">Check these subkeys:</span></span> 

- <span data-ttu-id="59d3f-250">Outlook 2016: HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\\</span><span class="sxs-lookup"><span data-stu-id="59d3f-250">Outlook 2016: HKEY_CURRENT_USER\Software\Microsoft\Office\16.0\Outlook\Security\\</span></span>
- <span data-ttu-id="59d3f-251">Outlook 2013: HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\\</span><span class="sxs-lookup"><span data-stu-id="59d3f-251">Outlook 2013: HKEY_CURRENT_USER\Software\Microsoft\Office\15.0\Outlook\Security\\</span></span>

<span data-ttu-id="59d3f-252">查找注册表项 EnableUnsafeClientMailRules。</span><span class="sxs-lookup"><span data-stu-id="59d3f-252">Look for the key EnableUnsafeClientMailRules.</span></span> <span data-ttu-id="59d3f-253">如果已存在并且设置为 1, 则表示 Outlook 安全修补程序已被覆盖, 并且计算机易受表单/规则攻击。</span><span class="sxs-lookup"><span data-stu-id="59d3f-253">If it is there and is set to 1, the Outlook security patch has been overridden and the computer is vulnerable to the Form/Rules attack.</span></span> <span data-ttu-id="59d3f-254">如果值为 0, 则禁用 "启动应用程序" 操作。</span><span class="sxs-lookup"><span data-stu-id="59d3f-254">If the value is 0, the “Start Application” action is disabled.</span></span>  <span data-ttu-id="59d3f-255">如果安装了已更新和修补的 Outlook 版本, 但此注册表项不存在, 则系统不易受到这些攻击。</span><span class="sxs-lookup"><span data-stu-id="59d3f-255">If the updated and patched version of Outlook is installed and this registry key is not present, then a system is not vulnerable to these attacks.</span></span>

<span data-ttu-id="59d3f-256">使用本地 Exchange 安装的客户应考虑阻止未提供修补程序的旧版本的 Outlook。</span><span class="sxs-lookup"><span data-stu-id="59d3f-256">Customers with on-premises Exchange installations should consider blocking older versions of Outlook that do not have patches available.</span></span> <span data-ttu-id="59d3f-257">有关此过程的详细信息, 请参阅[配置 Outlook 客户端阻止](https://technet.microsoft.com/en-us/library/dd335207(v=exchg.150).aspx)一文。</span><span class="sxs-lookup"><span data-stu-id="59d3f-257">Details on this process can be found in the article [Configure Outlook client blocking](https://technet.microsoft.com/en-us/library/dd335207(v=exchg.150).aspx).</span></span>

## <a name="secure-office-365-like-a-cybersecurity-pro"></a><span data-ttu-id="59d3f-258">安全的 Office 365, 如 cybersecurity pro</span><span class="sxs-lookup"><span data-stu-id="59d3f-258">Secure Office 365 like a cybersecurity pro</span></span>
<span data-ttu-id="59d3f-259">您的 Office 365 订阅附带了一组功能强大的安全功能, 可用于保护您的数据和用户。</span><span class="sxs-lookup"><span data-stu-id="59d3f-259">Your Office 365 subscription comes with a powerful set of security capabilities that you can use to protect your data and your users.</span></span>  <span data-ttu-id="59d3f-260">使用[Office 365 安全路线图: 前30天、90天和更高版本的首要优先级](https://support.office.com/article/Office-365-security-roadmap-Top-priorities-for-the-first-30-days-90-days-and-beyond-28c86a1c-e4dd-4aad-a2a6-c768a21cb352), 以实现 Microsoft 建议的保护 Office 365 租户的最佳做法。</span><span class="sxs-lookup"><span data-stu-id="59d3f-260">Use the [Office 365 security roadmap: Top priorities for the first 30 days, 90 days, and beyond](https://support.office.com/article/Office-365-security-roadmap-Top-priorities-for-the-first-30-days-90-days-and-beyond-28c86a1c-e4dd-4aad-a2a6-c768a21cb352) to implement Microsoft recommended best practices for securing your Office 365 tenant.</span></span>
- <span data-ttu-id="59d3f-261">在前30天内要完成的任务。</span><span class="sxs-lookup"><span data-stu-id="59d3f-261">Tasks to accomplish in the first 30 days.</span></span>  <span data-ttu-id="59d3f-262">这些值会立即生效, 并对用户造成影响较小。</span><span class="sxs-lookup"><span data-stu-id="59d3f-262">These have immediate affect and are low-impact to your users.</span></span>
- <span data-ttu-id="59d3f-263">要在90天内完成的任务。</span><span class="sxs-lookup"><span data-stu-id="59d3f-263">Tasks to accomplish in 90 days.</span></span> <span data-ttu-id="59d3f-264">它们需要花一点时间来规划和实施, 但大大提高了您的安全状况。</span><span class="sxs-lookup"><span data-stu-id="59d3f-264">These take a bit more time to plan and implement but greatly improve your security posture.</span></span>
- <span data-ttu-id="59d3f-265">超过90天。</span><span class="sxs-lookup"><span data-stu-id="59d3f-265">Beyond 90 days.</span></span> <span data-ttu-id="59d3f-266">这些增强功能将在您的前90天工作中构建。</span><span class="sxs-lookup"><span data-stu-id="59d3f-266">These enhancements build in your first 90 days work.</span></span>

## <a name="see-also"></a><span data-ttu-id="59d3f-267">另请参阅：</span><span class="sxs-lookup"><span data-stu-id="59d3f-267">See also:</span></span>
- <span data-ttu-id="59d3f-268">[恶意 outlook 规则](https://silentbreaksecurity.com/malicious-outlook-rules/)SilentBreak 安全公告关于规则矢量提供有关 Outlook 规则的详细审阅。</span><span class="sxs-lookup"><span data-stu-id="59d3f-268">[Malicious Outlook Rules](https://silentbreaksecurity.com/malicious-outlook-rules/) by SilentBreak Security Post about Rules Vector provides a detailed review of how the Outlook Rules.</span></span> 
- <span data-ttu-id="59d3f-269">[MAPI over HTTP 和 Mailrule Pwnage](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) on the Sensepost 博客 for Mailrule Pwnage 讨论了一个称为标尺的工具, 可让您通过 Outlook 规则利用邮箱。</span><span class="sxs-lookup"><span data-stu-id="59d3f-269">[MAPI over HTTP and Mailrule Pwnage ](https://sensepost.com/blog/2016/mapi-over-http-and-mailrule-pwnage/) on the Sensepost blog about Mailrule Pwnage discusses a tool called Ruler that lets you exploit mailboxes through Outlook rules.</span></span>
- <span data-ttu-id="59d3f-270">有关表单威胁向量的 Sensepost 博客上的[Outlook 窗体和 shell](https://sensepost.com/blog/2017/outlook-forms-and-shells/) 。</span><span class="sxs-lookup"><span data-stu-id="59d3f-270">[Outlook forms and shells](https://sensepost.com/blog/2017/outlook-forms-and-shells/) on the Sensepost blog about Forms Threat Vector.</span></span> 
- [<span data-ttu-id="59d3f-271">标尺基本代码</span><span class="sxs-lookup"><span data-stu-id="59d3f-271">Ruler Codebase</span></span>](https://github.com/sensepost/ruler)
- [<span data-ttu-id="59d3f-272">标尺指示器的危害</span><span class="sxs-lookup"><span data-stu-id="59d3f-272">Ruler Indicators of Compromise</span></span>](https://github.com/sensepost/notruler/blob/master/iocs.md)