---
title: Office 365 Exchange Online 数据删除
ms.author: robmazz
author: robmazz
manager: laurawi
ms.date: 8/21/2018
audience: ITPro
ms.topic: article
ms.service: Office 365 Administration
localization_priority: None
search.appverid:
- MET150
ms.collection: Strat_O365_Enterprise
description: 如何柔和及硬 Exchange Online 中处理数据删除。
ms.openlocfilehash: 3a17b09e9c21ae309e00bcb0ddc0b51b93478bc1
ms.sourcegitcommit: 36c5466056cdef6ad2a8d9372f2bc009a30892bb
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/27/2018
ms.locfileid: "22525255"
---
# <a name="exchange-online-data-deletion-in-office-365"></a>Office 365 中的 Exchange Online 数据删除
在 Exchange Online 中，有两种类型的删除： 软删除和硬删除。这适用于邮箱和邮箱内的项目。

## <a name="soft-deleted-and-hard-deleted-mailboxes"></a>软删除和硬删除邮箱
软删除用户邮箱的邮箱已使用 Office 365 管理中心或 Remove-mailbox cmdlet 被删除，仍已在 Azure Active Directory 回收站小于 30 天。邮箱可能会变得软删除任何通过以下方式：
- 用户邮箱关联的 Azure Active Directory 用户帐户是软删除 （超出范围或 recycle bin 容器中为用户对象）。
- 已硬删除的用户邮箱关联的 Azure Active Directory 用户帐户但 Exchange Online 邮箱处于诉讼保留或电子数据展示保留。
- 用户邮箱的相关联的 Azure Active Directory 用户帐户已清除内最近 30 天;这是 Exchange Online 的保留的最大长度将保留邮箱中的软删除状态之前永久清除且不可恢复。

硬删除用户邮箱是邮箱已删除的以下方法之一：
- 用户邮箱已软删除超过 30 天，并且关联的 Azure Active Directory 用户已硬删除。被永久删除所有邮箱内容，如电子邮件、 联系人和文件。
- 与用户邮箱关联的用户帐户已硬删除在 Azure Active Directory 中。用户邮箱目前软删除 Exchange Online 中，并且将停留在软删除状态 30 天。如果在 30 天内的新的 Azure Active Directory 用户同步从原始收件人帐户需要具有相同的**ExchangeGuid**或**ArchiveGuid**，并且新帐户授权的 Exchange Online，这将导致的硬删除原始的用户邮箱。被永久删除所有邮箱内容，如电子邮件、 联系人和文件。
- 使用**Remove-mailbox PermanentlyDelete**删除软删除邮箱。

上面的删除方案假定用户邮箱不在任何一种保留状态，如诉讼保留或电子数据展示保留。如果没有任何类型的邮箱的保留，无法删除邮箱。对于所有邮件用户收件人类型，任何[保留](https://support.office.com/article/manage-legal-investigations-in-office-365-2e5fbe9f-ee4d-4178-8ff8-4356bc1b168e?ui=en-US&rs=en-US&ad=US)设置将被忽略和硬删除或软删除没有影响。

## <a name="soft-deleted-and-hard-deleted-items"></a>软删除和硬删除项目
当用户删除邮箱项目 （如电子邮件、 联系人、 日历约会，或任务中） 时，项目将被移动到可恢复邮件文件夹中，并到一个名为删除子。这称为软删除。长已删除项目的保留中删除文件夹取决于为邮箱已删除的邮件保留期限。默认情况下，为 14 天 Exchange Online 邮箱保留已删除的项目，但 Exchange Online 管理员可以更改此设置，以增加 30 天内的最多的时间段。（来提高 Exchange Online 邮箱的已删除的邮件保留期的详细步骤，请参阅[Exchange Online 邮箱将保留更改长永久删除项目](https://docs.microsoft.com/exchange/recipients-in-exchange-online/manage-user-mailboxes/change-deleted-item-retention)。）用户可以恢复，或清除已删除的项目之前已删除邮件的保留时间过期。为此，请他们使用在 Microsoft Outlook 或 Outlook web 上的中恢复已删除邮件功能。

如果用户使用 Outlook 或 Outlook web 上的中恢复已删除邮件功能清除已删除的项目，这称为硬删除。在 Exchange Online 中，单个项目恢复时，会启用默认情况下创建一个新的邮箱后，因此管理员仍然可以[恢复](https://docs.microsoft.com/Exchange/recipients/user-mailboxes/recover-deleted-messages)硬已删除邮件已删除的邮件保留期到期之前。此外，如果因用户或进程更改一条消息，则在启用单个项目恢复时，将还保留的原始项目副本。

## <a name="page-zeroing"></a>页面清零
*Zeroing*是通过已删除的数据写入零或一种二进制模式，以便能够更加难以恢复已删除的数据的安全机制。Exchange Online 中邮箱数据库*页面*用作其单位的存储，并实现调用*页清零*的覆盖流程。默认情况下启用，页清零，并且不能禁用客户或由 Microsoft。页清操作记录在事务日志文件，以便给定数据库的所有副本都页-清都零以类似方式。清零的主动数据库副本上的网页中使页面以获取清零的数据库的被动副本。

页清零通过硬删除记录中写入一种二进制模式。页清零的模式是特定于可扩展存储引擎 (ESE) 操作 （内部数据库引擎的名称由服务器在 Exchange Online），并且它与后台数据库维护操作运行时操作的不同。（后台数据库维护是连续校验和和扫描每个数据库的过程。其主要功能是向校验和数据库页，但它还处理清理空间并出记录和由于存储崩溃出之间已不的清零的页清零）。

下表列出对应于特定运行时操作的填充模式。

| ESE 运行时操作   | 填充模式 |
|--------------------------|--------------|
| 替换                  | R            |
| 记录/长数值删除 | D            |
| 释放的页空间         | H            |


下表列出对应于在 ESE 后台数据库维护期间进行的特定操作的填充模式。

| ESE 后台数据库维护操作 | 填充模式 |
|-----------------------------------------------|--------------|
| 记录删除                                 | D            |
| 长数值删除                             | L            |
| 部分使用的页的释放页空间       | Z            |
| 未使用的页的释放页空间               | U            |


### <a name="page-zeroing-process"></a>页清零的过程
针对页清零的过程取决于删除方案。下表讨论数据库删除方案以及页清函数发生。

| 数据库删除方案 | 对数据库数据清零的 ESE 过程和时间范围 |
|-----------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| 项过期基于上已删除的邮件保留期限。 | 一个异步线程对删除的数据写入二进制模式。此操作在数毫秒的记录删除过程中发生。如果存储过程崩溃，而异步清零工作仍未完成（或由于版本存储增长而取消了版本存储清理），则当后台数据库维护处理该部分数据库时会完成清零。 |
| 视图方案： 中的项目过期 Outlook/Outlook web 文件夹视图 （例如，对话视图） | 当后台数据库维护处理该部分数据库时会进行数据清零。 |
| 移动邮箱/删除邮箱方案： 源邮箱已删除 （的已删除邮箱过期） | 当后台数据库维护处理该部分数据库时会进行数据清零。 |

### <a name="mailbox-data-types-without-page-zeroing"></a>不进行页清零的邮箱数据类型
以下邮箱数据类型有没有针对页清零的设置：
- **邮箱数据库事务日志**-时正常操作的一部分删除事务日志，没有为零存储已删除的日志文件在文件系统中的块的进程。很可能在文件系统将快速重新利用的可用空间用于新创建的日志，但不能保证，这会发生。
- **内容索引编录文件**-Exchange Online 使用搜索索引功能 Search Foundation (也称为 FAST)。搜索索引编录由存储在与邮箱数据库文件相同的卷上的多个许多文件。硬删除邮箱数据库从一条消息时，不会立即删除搜索目录中关联的内容。Search Foundation 执行时发生内容删除阴影 （或主合并） 到单个较大文件许多小型编录文件中。主合并完成后，将删除较小的编录文件。没有为零的基块的存储已删除的编录文件的进程。

## <a name="continuous-replication"></a>连续复制
连续复制 （也称为日志传送和重播） 是在 Exchange Online 中创建和维护的每个以提供高可用性和站点恢复灾难恢复的邮箱数据库副本的技术。连续复制利用 Exchange Server 数据库故障恢复支持提供执行异步更新的一个或多个邮箱数据库副本的技术。每个邮箱服务器记录为 1 MB 事务日志文件的顺序的集中日志记录数据库上的活动数据库 （例如，用户电子邮件活动） 所做的更新。这组文件称为日志流。连续复制日志流还用于异步更新数据库的一个或多个副本。通过传输日志达到此目的到包含活动数据库的被动副本，然后将它们重播到被动数据库副本的位置。如果针对数据库的被动副本重播活动数据库中的所有日志，然后两个数据库是等效的并且通过此过程对活动数据库所做的任何物理更改被复制到该数据库的所有被动副本。

从邮箱数据库，任何删除邮箱项目或整个邮箱后，以及是否软删除或硬-删除，表示物理更改到活动的数据库。页清零也需要更改活动的数据库的物理。这些更改写入日志文件通过称为连续复制的过程和时对数据库的被动副本重放这些日志文件，将相同的物理更改对这些被动数据库。