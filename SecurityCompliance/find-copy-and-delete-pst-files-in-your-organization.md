---
title: 使用 PST 集合工具查找、 复制和删除组织中的 PST 文件
ms.author: markjjo
author: markjjo
manager: laurawi
ms.date: ''
ms.audience: Admin
ms.topic: article
ms.service: o365-administration
localization_priority: Normal
ms.collection: Strat_O365_IP
search.appverid: MOE150
ms.assetid: 7a150c84-049c-4a9c-8c91-22355b35f2a7
description: 使用 Microsoft PST 集合工具搜索贵组织的网络，若要获取分散在您的组织的 PST 文件的清单。查找 PST 文件后，您可以使用 PST 集合工具以将其复制在一个中心位置，以便您可以将其导入 Office 365。
ms.openlocfilehash: 34395eee7776d8bff1ddccb7fed5b683e97c02c7
ms.sourcegitcommit: c59a082dca6593d0e35e58124ee6ba240547bfa5
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 12/05/2018
ms.locfileid: "27154208"
---
# <a name="use-the-pst-collection-tool-to-find-copy-and-delete-pst-files-in-your-organization"></a><span data-ttu-id="3a592-104">使用 PST 集合工具查找、 复制和删除组织中的 PST 文件</span><span class="sxs-lookup"><span data-stu-id="3a592-104">Use the PST Collection tool to find, copy, and delete PST files in your organization</span></span>

> [!IMPORTANT]
> <span data-ttu-id="3a592-p102">本文中所述的 PST 集合工具不支持任何 Microsoft 标准支持程序或服务。该工具原样提供，没有任何形式的担保。Microsoft 进一步否认所有默示的担保，包括但不限于，任何暗示对适销性或针对特定用途的适用性的担保。因使用或性能的工具和文档的全部风险您自己承担。在任何情况 Microsoft、 作者，或 else 参与创建、 生产或传递的工具的任何人都概的因任何损害向 （包括但不限于损失业务损失、 业务中断丢失业务信息或其他 pecuniary 丢失） 因使用或不能使用工具或文档，即使 Microsoft 已被告知此类损害的可能性。</span><span class="sxs-lookup"><span data-stu-id="3a592-p102">The PST Collection tool described in this article isn’t supported under any Microsoft standard support program or service. The tool is provided AS IS without warranty of any kind. Microsoft further disclaims all implied warranties including, without limitation, any implied warranties of merchantability or of fitness for a particular purpose. The entire risk arising out of the use or performance of the tool and documentation remains with you. In no event shall Microsoft, its authors, or anyone else involved in the creation, production, or delivery of the tool be liable for any damages whatsoever (including, without limitation, damages for loss of business profits, business interruption, loss of business information, or other pecuniary loss) arising out of the use of or inability to use the tool or documentation, even if Microsoft has been advised of the possibility of such damages.</span></span>

<span data-ttu-id="3a592-p103">Microsoft PST 收集工具可用于搜索的 PST 文件的组织的网络。该工具可帮助您获得分散在您的组织的 PST 文件的清单。查找 PST 文件后，您可以使用 PST 集合工具以将其复制在一个中心位置。无 Pst 在一个位置，然后允许您导入到 Exchange Online 邮箱 （或单个 Exchange Online 邮箱），然后可应用丰富的 Office 365 中的合规性功能。这包括将 Pst 导入到用户的邮箱，搜索特定邮件已导入使用电子数据展示搜索工具，邮件保留使用电子数据展示 PST 文件中包含的存档和 Office 365 保留策略，以及管理生命周期周期的使用消息这些邮件记录管理功能在 Exchange Online。确信您收集的 PST 文件已成功导入到 Office 365 后，您可以使用工具在您的网络从其原始位置删除它们。</span><span class="sxs-lookup"><span data-stu-id="3a592-p103">You can use the Microsoft PST Collection tool to search your organization's network for PST files. The tool helps you get an inventory of PST files that are scattered throughout your organization. After you find PST files, you can use the PST Collection tool to copy them in a central location. Having PSTs in a one place then allows you to import them to Exchange Online mailboxes (or a single Exchange Online mailbox), where you can then apply the rich set of compliance features in Office 365. This includes importing PSTs to users' archive mailboxes, searching for specific messages in the PST files that you imported by using eDiscovery search tools, retaining messages by using eDiscovery holds and Office 365 retention policies, and managing the life cycle of these messages using the messaging records management features in Exchange Online. After you're confident that the PST files that you collected have been successfully imported to Office 365, you can use the tool to delete them from their original location on your network.</span></span> 
  
<span data-ttu-id="3a592-p104">用 PST 收集工具能做的另一个事情是阻止用户创建新的 PST 文件和更改查找网络的现有 PST 文件。这些"阻止"功能允许您查找、 收集和一组已知的 PST 文件导入 Office 365 和阻止的组织中的 PST 文件将来扩散打开了。</span><span class="sxs-lookup"><span data-stu-id="3a592-p104">Another thing you can do with the PST Collection tool is prevent users from creating new PST files and changing the existing PST files that you find on your network. These "block" capabilities let you find, collect, and import a known set of PST files to Office 365 and prevent the future proliferation of PST files in your organization.</span></span> 
  
## <a name="how-the-pst-collection-tool-works"></a><span data-ttu-id="3a592-118">PST 集合工具的工作方式</span><span class="sxs-lookup"><span data-stu-id="3a592-118">How the PST Collection tool works</span></span>

<span data-ttu-id="3a592-119">下面是过程的使用 PST 收集工具查找、 控制、 收集和删除组织中的 PST 文件的快速概述。</span><span class="sxs-lookup"><span data-stu-id="3a592-119">Here's a quick overview of the process of using the PST Collection tool to find, control, collect, and delete PST files in your organization.</span></span>
  
![PST 集合工具过程概述](media/67a29f27-f83c-4f0a-9df4-7ed92d3086fe.png)
  
1. <span data-ttu-id="3a592-p105">**[步骤 1： 查找在您的网络的 PST 文件](#step-1-find-pst-files-on-your-network)**-当您运行工具查找 PST 文件，指定一个位置，例如包含客户端和服务器的计算机的 Active Directory 对象的组织单位。您还可以搜索特定计算机或网络文件共享。运行该工具时，在目标计算机上安装"轻型"集合代理。此代理搜索 PST 文件的目标计算机，然后将信息发送回有关发现任何 PST 文件的 PST 集合工具。此工具创建日志文件包含有关在指定位置中找到的 PST 文件的信息。后续步骤中运行该工具时使用这些文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p105">**[Step 1: Find PST files on your network](#step-1-find-pst-files-on-your-network)** - When you run the tool to find PST files, you specify a location, such as an organizational unit that contain Active Directory objects for client and server computers. You can also search specific machines or network file shares. When you run the tool, a "lightweight" Collection Agent is installed on the target computers. This agent searches the target computer for PST files and then sends information back to the PST Collection tool about any PST file it finds. The tool creates log files that contains information about the PST files that were found in the specified locations. These files are used when you run the tool in later steps.</span></span> 
    
2. <span data-ttu-id="3a592-p106">**[（可选） 步骤 2： 控制对 PST 文件的访问](#optional-step-2-control-access-to-pst-files)**-工具创建组策略对象 (GPO) 具有阻止用户创建或更改 PST 文件的设置。此 GPO 应用于您的域中的每个用户。此可选步骤将帮助您"锁定"，以便可以收集、 导入，并删除这些而无需创建新的 PST 文件在步骤 1 中，找到 PST 文件或更改现有 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p106">**[(Optional) Step 2: Control access to PST files](#optional-step-2-control-access-to-pst-files)** - The tool creates a Group Policy Object (GPO) with settings that prevent users from creating or changing PST files. This GPO is applied to every user in your domain. This optional step helps you "lock down" the PST files that were found in Step 1, so that you can collect, import, and delete them without having new PST files created or the existing PST files changed.</span></span> 
    
3. <span data-ttu-id="3a592-p107">**[步骤 3： 将 PST 文件复制到集合位置](#step-3-copy-the-pst-files-to-a-collection-location)**-这允许您收集在一个位置的 PST 文件，以便您可以将其导入 Exchange Online 邮箱步骤 4 中使用的导入 Office 365 服务。在"收集"模式下运行该工具时，每个集合代理将安装代理集位置到目标计算机复制 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p107">**[Step 3: Copy the PST files to a collection location](#step-3-copy-the-pst-files-to-a-collection-location)** - This lets you collect the PST files in one location so that you can import them to Exchange Online mailboxes by using the Office 365 Import service in Step 4. When you run the tool in the "collect" mode, each Collection Agent copies the PST files from the target machine the agent is installed on to the collection location.</span></span> 
    
4. <span data-ttu-id="3a592-132">**[步骤 4： 将 PST 文件导入到 Office 365](#step-4-import-the-pst-files-to-office-365)** -已 PST 文件复制到一个位置后，您准备好进行导入到 Exchange Online 邮箱。</span><span class="sxs-lookup"><span data-stu-id="3a592-132">**[Step 4: Import the PST files to Office 365](#step-4-import-the-pst-files-to-office-365)** - After you've copied the PST files to one location, you're ready to import them to Exchange Online mailboxes.</span></span> 
    
5. <span data-ttu-id="3a592-133">**[步骤 5： 网络找到的 PST 文件的删除](#step-5-delete-the-pst-files-found-on-your-network)**-PST 文件，找到并收集已导入到 Office 365 中的 Exchange Online 邮箱，您可以使用 PST 收集工具从原始位置删除 PST 文件后，它们步骤 1 中找到。</span><span class="sxs-lookup"><span data-stu-id="3a592-133">**[Step 5: Delete the PST files found on your network](#step-5-delete-the-pst-files-found-on-your-network)** - After the PST files that you found and collected have been imported to Exchange Online mailboxes in Office 365, you can use the PST Collection tool to delete the PST files from the original locations where they were found in Step 1.</span></span> 

## <a name="before-you-begin"></a><span data-ttu-id="3a592-134">准备工作</span><span class="sxs-lookup"><span data-stu-id="3a592-134">Before you begin</span></span>

- <span data-ttu-id="3a592-135">按照以下步骤以下载到本地计算机的 PST 收集工具。</span><span class="sxs-lookup"><span data-stu-id="3a592-135">Follow these steps to download the PST Collection tool to your local computer.</span></span> 
    
    1. <span data-ttu-id="3a592-136">[下载 PST 集合工具](https://aka.ms/pstcollectiontool)。</span><span class="sxs-lookup"><span data-stu-id="3a592-136">[Download the PST Collection tool](https://aka.ms/pstcollectiontool).</span></span>
    
    2. <span data-ttu-id="3a592-137">在弹出窗口中，单击**保存** \> **另存为**本地计算机上将 PSTCollectionTool.zip 文件保存到文件夹。</span><span class="sxs-lookup"><span data-stu-id="3a592-137">In the pop-up window, click **Save** \> **Save as** to save the PSTCollectionTool.zip file to a folder on your local computer.</span></span> 
    
    3. <span data-ttu-id="3a592-138">PSTCollectionTool.zip 将文件提取到一个文件夹在本地计算机。默认文件夹名称是 PSTCollectionTool。</span><span class="sxs-lookup"><span data-stu-id="3a592-138">Extract the PSTCollectionTool.zip file to a folder on your local computer; the default folder name is PSTCollectionTool.</span></span>
    
- <span data-ttu-id="3a592-139">若要在任何模式 （查找、 阻止、 复制或删除） 中运行 PST 收集工具，您必须是 Active Directory 域中的 Domain Administrators 组的成员。</span><span class="sxs-lookup"><span data-stu-id="3a592-139">To run the PST Collection tool in any mode (Find, Block, Copy, or Delete), you have to be a member of the Domain Administrators group in your Active Directory domain.</span></span> 

## <a name="step-1-find-pst-files-on-your-network"></a><span data-ttu-id="3a592-140">步骤 1： 查找在您的网络的 PST 文件</span><span class="sxs-lookup"><span data-stu-id="3a592-140">Step 1: Find PST files on your network</span></span>

<span data-ttu-id="3a592-p108">第一步是运行 PST 集合工具查找组织中的 PST 文件。此工具可用于搜索以下类型的位置。</span><span class="sxs-lookup"><span data-stu-id="3a592-p108">The first step is to run the PST Collection tool to find PST files in your organization. You can use the tool to search the following types of locations.</span></span> 
  
- <span data-ttu-id="3a592-p109">内部部署 Active Directory 域中的组织单位 (Ou)。该工具将搜索指定的 OU 中包含的所有计算机。</span><span class="sxs-lookup"><span data-stu-id="3a592-p109">Organizational units (OUs) in an on-premises Active Directory domain. The tool searches all the machines that are contained in the specified OU.</span></span> 
    
- <span data-ttu-id="3a592-p110">客户端和服务器的计算机。该工具将搜索指定的计算机。</span><span class="sxs-lookup"><span data-stu-id="3a592-p110">Client and server computers. The tool searches the specified machines.</span></span> 
    
- <span data-ttu-id="3a592-p111">网络文件共享。该工具将搜索指定的网络文件共享。</span><span class="sxs-lookup"><span data-stu-id="3a592-p111">Network file shares. The tool searches the specified network file shares.</span></span> 
    
<span data-ttu-id="3a592-149">说明，请参阅`Locations`的语法来使用这些位置类型的每个示例的以下过程中的表中的参数。</span><span class="sxs-lookup"><span data-stu-id="3a592-149">See the description for the  `Locations` parameter in table in the following procedure for examples of the syntax to use for each of these location types.</span></span> 
  
> [!IMPORTANT]
> <span data-ttu-id="3a592-150">您具有到运行查找模式的 PST 集合工具才能执行其他操作，如阻止、 收集，或删除 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-150">You have to the run the PST Collection tool in the Find mode before you can perform other actions such as blocking, collecting, or deleting PST files.</span></span> 
  
1. <span data-ttu-id="3a592-151">在本地计算机上打开命令提示符 （以管理员身份运行）。</span><span class="sxs-lookup"><span data-stu-id="3a592-151">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="3a592-152">转到 PSTCollectionTool 文件夹 （或提取到的 PSTCollectionTool.zip 文件的文件夹）。</span><span class="sxs-lookup"><span data-stu-id="3a592-152">Go to the PSTCollectionTool folder (or the folder that you extracted the PSTCollectionTool.zip file to).</span></span>
    
3. <span data-ttu-id="3a592-153">转到 DataCollectorMaster 目录。</span><span class="sxs-lookup"><span data-stu-id="3a592-153">Change to the DataCollectorMaster directory.</span></span>
    
4. <span data-ttu-id="3a592-154">运行以下命令以查找 PST 文件中指定的位置。</span><span class="sxs-lookup"><span data-stu-id="3a592-154">Run the following command to find PST files in a specified location.</span></span>
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Find -JobName <Name> -Locations <Locations to search for PSTs> -LogLocation <Location to store log files> -ConfigurationLocation <Location to store configuration files>
    ```

    <span data-ttu-id="3a592-155">下表介绍参数以及它们所需的值，当您运行 DataCollectorMaster.exe 命令，以查找 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-155">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to find PST files.</span></span> 
    
    |<span data-ttu-id="3a592-156">参数 \*\*\*</span><span class="sxs-lookup"><span data-stu-id="3a592-156">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="3a592-157">\*\*\*\*Description\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="3a592-157">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="3a592-158">示例 \*\*\*</span><span class="sxs-lookup"><span data-stu-id="3a592-158">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="3a592-p112">指定要搜索数据的类型。目前，您可以使用 PST 收集工具搜索 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p112">Specifies the type of data to search for. Currently, you can use the PST Collection tool to search for PST files.</span></span>  <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="3a592-p113">指定该工具将执行的操作的类型。使用值`Find`来查找 PST 文件中指定的位置。请注意该工具可以查找和获取有关连接到 Outlook 配置文件的 Outlook 和 PST 文件中打开的 PST 文件的信息。</span><span class="sxs-lookup"><span data-stu-id="3a592-p113">Specifies the type of operation that the tool will perform. Use the value  `Find` to locate PST files in the specified locations. Note that the tool can find and get information about PST files that are open in Outlook and PST files that are connected to Outlook profiles.  </span></span><br/> | `-Mode Find` <br/> |
    | `JobName` <br/> |<span data-ttu-id="3a592-p114">指定 PST 集合作业的名称。运行 PST 集合工具，以阻止、 收集和删除位于运行工具查找 PST 文件时的 PST 文件时，您将使用此相同的作业名称。作业名称也将添加到日志和配置文件名称。</span><span class="sxs-lookup"><span data-stu-id="3a592-p114">Specifies the name of the PST Collection job. You will use this same job name when you run the PST Collection tool to block, collect, and delete the PST files that are found when you run the tool to find PST files. The job name will also be added to the log and configuration file names.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `Locations` <br/> | <span data-ttu-id="3a592-p115">指定要搜索的 PST 文件的一个或多个位置。如果您指定多个位置，请使用分号 （;） 分隔各个位置。请务必包围各个值的此参数与双引号 ("")。</span><span class="sxs-lookup"><span data-stu-id="3a592-p115">Specifies one or more locations to search for PST files. If you specify more than one location, use a semi-colon (;) to separate individual locations. Be sure to surround the individual values of this parameter with double-quotation marks (" ").  </span></span><br/><br/>   <span data-ttu-id="3a592-170">下面是可以搜索的位置的类型的必需的 identity 值格式。</span><span class="sxs-lookup"><span data-stu-id="3a592-170">Here is the required identity value format for the types of locations that you can search.</span></span>  <br/><br/>        <span data-ttu-id="3a592-171">**Ou** -使用的可分辨名称 (DN) 来标识 Ou;例如：`"OU=NorthAmerica,OU=NWRegion,OU=ITServices,DC=contoso,DC=com"`</span><span class="sxs-lookup"><span data-stu-id="3a592-171">**OUs** - Use the distinguished name (DN) to identify OUs; for example:  `"OU=NorthAmerica,OU=NWRegion,OU=ITServices,DC=contoso,DC=com"`</span></span> <br/> <span data-ttu-id="3a592-172">> [!IMPORTANT]> 不能指定内置的计算机容器 (例如，CN = Computers，DC = contoso，DC = com") 因为组织单位。</span><span class="sxs-lookup"><span data-stu-id="3a592-172">> [!IMPORTANT]>  You can't specify the built-in Computers container (for example, CN=Computers,DC=contoso,DC=com") because it isn't an organizational unit.</span></span><br/> <br/> <span data-ttu-id="3a592-173">**机**-使用 DN 或完全限定的域名 (FQDN) 来确定客户端和服务器网络内计算机上;例如：</span><span class="sxs-lookup"><span data-stu-id="3a592-173">**Machines** - Use the DN or the fully qualified domain name (FQDN) to identify client and server machines on your network; for example:</span></span>  <br/>  <span data-ttu-id="3a592-174">DN:`"CN=FILESERVER01,CN=Computers,DC=contoso,DC=com"`</span><span class="sxs-lookup"><span data-stu-id="3a592-174">DN:  `"CN=FILESERVER01,CN=Computers,DC=contoso,DC=com"`</span></span> <br/>  <span data-ttu-id="3a592-175">或</span><span class="sxs-lookup"><span data-stu-id="3a592-175">Or</span></span>  <br/>  <span data-ttu-id="3a592-176">FQDN:`"FILESERVER01.contoso.com"`</span><span class="sxs-lookup"><span data-stu-id="3a592-176">FQDN:  `"FILESERVER01.contoso.com"`</span></span> <br/><br/>  <span data-ttu-id="3a592-177">**网络文件共享**-使用 UNC 名称来标识网络文件共享;例如，`"\\FILESERVER02\Users"`</span><span class="sxs-lookup"><span data-stu-id="3a592-177">**Network file shares** - Use a UNC name to identify network file shares; for example,  `"\\FILESERVER02\Users"`</span></span> <br/> | `-Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com";"CN=FILESERVER02,CN=Computers,DC=contoso,DC=com"` <br/> |
    | `LogLocation` <br/> |<span data-ttu-id="3a592-p116">指定日志文件将被复制到的文件夹。如果文件夹不存在，将运行该工具时创建它。</span><span class="sxs-lookup"><span data-stu-id="3a592-p116">Specifies the folder that the log files will be copied to. If the folder doesn't exist, it will be created when you run the tool.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="3a592-p117">指定.xml 配置文件将被复制到的文件夹。此文件包含有关运行该工具时找到每个 PST 文件的信息。步骤 3 复制找到 PST 文件中运行该工具时，将使用此文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p117">Specifies the folder that the .xml configuration file will be copied to. This file contains information about each PST file that is found when you run the tool. This file will be used when you run the tool in Step 3 to copy the PST files that are found.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration"` <br/> |
    | `ExcludedLocations` <br/> |<span data-ttu-id="3a592-p118">此可选参数指定要跳过查找操作过程中的位置。您可以排除特定 Ou、 机和网络文件共享。例如，可以排除机，如配置为 SQL server （或其他类型的应用程序服务器） 的计算机，用户不能访问。如果您指定要排除的多个位置，请使用分号 （;） 分隔各个位置。请务必包围各个值的此参数与双引号 ("")。</span><span class="sxs-lookup"><span data-stu-id="3a592-p118">This optional parameter specifies locations to skip during a Find operation. You can exclude specific OUs, machines, and network file shares. For example, you could exclude machines, such as machine configured as a SQL server (or other kinds of application servers), that users don't have access to. If you specify more than one location to exclude, use a semi-colon (;) to separate individual locations. Be sure to surround the individual values of this parameter with double-quotation marks (" ").</span></span>  <br/> | `-ExcludedLocations "SQLSERVER01.contoso.com"` <br/> |
    | `ForceRestart` <br/> |<span data-ttu-id="3a592-p119">此可选开关，可以在现有 PST 集合作业的查找模式运行该工具。当您使用`ForceRestart`切换，以前的查找操作的结果将丢弃该作业，并在工具将重新扫描的指定的位置和创建新的日志和配置文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p119">This optional switch lets you run the tool in the Find mode for an existing PST Collection job. When you use the  `ForceRestart` switch, the results from the previous Find operation for the job will be discarded, and the tool will re-scan the specified locations and create new log and configuration files.  </span></span><br/> | `-ForceRestart` <br/> |
   
    <span data-ttu-id="3a592-190">下面是语法的使用实际值的每个参数 DataCollectorMaster.exe 命令示例：</span><span class="sxs-lookup"><span data-stu-id="3a592-190">Here's an example of the syntax for the DataCollectorMaster.exe command using actual values for each parameter:</span></span>
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Find -JobName PstSearch1 -Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com";"CN=FILESERVER02,CN=Computers,DC=contoso,DC=com" -LogLocation "c:\users\admin\desktop\PSTCollection" -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration"
    ```

    <span data-ttu-id="3a592-p120">运行该命令后，则显示详细的状态消息的显示在指定位置查找 PST 文件的进度。后一段时间，最终状态消息显示找到的 PST 文件的总数、 是否完成该作业后，和如果没有任何错误。相同的状态邮件复制到.log 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p120">After you run the command, detailed status messages are displayed that show the progress of finding PST files in the specified locations. After a while, a final status message shows the total number of PST files that were found, whether the job has completed, and if there were any errors. The same status messages are copied to the .log file.</span></span>
    
### <a name="results-of-running-datacollectormasterexe-in-the-find-mode"></a><span data-ttu-id="3a592-194">在查找模式下运行 DataCollectorMaster.exe 的结果</span><span class="sxs-lookup"><span data-stu-id="3a592-194">Results of running DataCollectorMaster.exe in the Find mode</span></span>

<span data-ttu-id="3a592-195">在成功运行 PST 收集工具查找模式后，创建并通过指定的文件夹中存储以下文件`LogLocation`和`ConfigurationLocation`参数。</span><span class="sxs-lookup"><span data-stu-id="3a592-195">After you successfully run the PST Collection tool the Find mode, the following files are created and stored in the folders specified by the  `LogLocation` and  `ConfigurationLocation` parameters.</span></span> 
  
- <span data-ttu-id="3a592-p121">**\<JobName\>_查找_\<DateTimeStamp\>.log** -日志文件中包含已显示状态消息。在指定的文件夹中创建此文件`LogLocation`参数。</span><span class="sxs-lookup"><span data-stu-id="3a592-p121">**\<JobName\>_Find_\<DateTimeStamp\>.log** - The log file contains the status messages that were displayed. This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
- <span data-ttu-id="3a592-p122">**\<JobName\>_查找_\<DateTimeStamp\>.csv** -CSV 文件包含为每个找的 PST 文件的行。每个 PST 的信息包括在其中发现，PST 文件的完整文件路径位置、 PST 文件中，和 PST 文件的大小 （以千字节，知识库） 的所有者的 PST 文件的计算机。在指定的文件夹中创建此文件`LogLocation`参数。</span><span class="sxs-lookup"><span data-stu-id="3a592-p122">**\<JobName\>_Find_\<DateTimeStamp\>.csv** - The CSV file contains a row for each PST file that was found. The information for each PST includes the computer where the PST file was found, the full file path location of the PST file, the owner of the PST file, and the size (in kilobytes, KBs) of the PST file. This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
    > [!TIP]
    > <span data-ttu-id="3a592-p123">使用 Excel 中的自动求和工具来计算该 CSV 文件中列出的所有 PST 文件的总大小 （以 kb 为单位）。然后您可以使用转换计算器转换的总大小 (mb) 或千兆字节 (GB)。</span><span class="sxs-lookup"><span data-stu-id="3a592-p123">Use the AutoSum tool in Excel to calculate the total size (in KB) of all the PST files listed in the CSV file. Then you can use a conversion calculator to convert the total size to megabytes (MB) or gigabytes (GB).</span></span> 
  
- <span data-ttu-id="3a592-p124">**\<JobName\>_查找_\<DateTimeStamp\>.xml** -XML 文件包含何类信息参数值的位置查找模式中运行该工具时使用。此文件还包含有关找到的每个 PST 文件的信息。重新运行相同的工具收集，作业到块中，或删除 PST 文件找到的运行时使用此文件中的数据。在指定的文件夹中创建此文件`ConfigurationLocation`参数。</span><span class="sxs-lookup"><span data-stu-id="3a592-p124">**\<JobName\>_Find_\<DateTimeStamp\>.xml** - The XML file contains information about the parameter values that where used when you ran the tool in the Find mode. This file also contains information about every PST file that was found. The data in this file is used when you run re-run the tool for the same job to block, collect, or delete the PST files that were found. This file is created in the folder specified by the  `ConfigurationLocation` parameter.</span></span> 
    
    > [!IMPORTANT]
    > <span data-ttu-id="3a592-p125">不重命名、 更改或移动该文件。它使用 PST 收集工具在块、 复制、 重新运行该工具或删除模式相同的作业时。</span><span class="sxs-lookup"><span data-stu-id="3a592-p125">Don't rename, change, or move this file. It's used by the PST Collection tool when you re-run the tool in the Block, Copy, or Delete mode for the same job.</span></span> 

## <a name="optional-step-2-control-access-to-pst-files"></a><span data-ttu-id="3a592-209">（可选）步骤 2： 控制对 PST 文件的访问</span><span class="sxs-lookup"><span data-stu-id="3a592-209">(Optional) Step 2: Control access to PST files</span></span>

<span data-ttu-id="3a592-p126">此可选步骤，您可以"锁定"，以便您可以收集在步骤 1 中找到的 PST 文件和导入到 Office 365 的一组已知的 PST 文件。阻止模式中运行 PST 收集工具时，会发生以下情况：</span><span class="sxs-lookup"><span data-stu-id="3a592-p126">This optional step lets you "lock down" the PST files that were found in Step 1 so that you can collect and import a known set of PST files to Office 365. When you run the PST Collection tool in the Block mode, the following things happen:</span></span> 
  
- <span data-ttu-id="3a592-p127">此工具创建名为*PST 使用率控件*组策略对象 (GPO)。此 GPO 链接到您的域，并且适用于您的组织中的所有经过身份验证的用户。</span><span class="sxs-lookup"><span data-stu-id="3a592-p127">The tool creates a Group Policy Object (GPO) named  *PST Usage Controls*  . This GPO is linked to your domain, and applies to all authenticated users in your organization.</span></span> 
    
- <span data-ttu-id="3a592-p128">PST 使用率控件 GPO 创建您的组织中的计算机上的注册表设置。根据您使用的参数，您可以创建一个注册表设置来阻止用户创建新的 PST 文件和注册表设置，禁止用户更改现有 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p128">The PST Usage Controls GPO creates registry settings on machines in your organization. Depending on the parameter that you use, you can create a registry setting to prevent users from creating new PST files and a registry setting that prevents users from changing existing PST files.</span></span>
    
> [!NOTE]
> <span data-ttu-id="3a592-p129">如果您的组织太中断控制对 PST 文件的访问，则可以考虑跳过此步骤中，并执行步骤 3 将 PST 文件复制到一个中心位置。然后您可以重复步骤 1 的相同的作业 (使用`ForceRestart`参数) 来查找其他后 Pst 文件复制到集合位置创建的 Pst 文件。如果找到新的 PST 文件，您可以将其复制到集合位置。当您使用`ForceRestart`参数重新查找模式中运行该工具时，将放弃作业以前的查找操作的结果，该工具将重新扫描的指定的位置。</span><span class="sxs-lookup"><span data-stu-id="3a592-p129">If controlling access to PST files is too disruptive for your organization, you might consider skipping this step, and performing Step 3 to copy PST files to a central location. Then you can repeat Step 1 for the same job (by using the  `ForceRestart` parameter) to find additional PSTs files that were created after you copied PSTs files to the collection location. If new PST files are found, you can copy them to the collection location. When you use the  `ForceRestart` parameter when you re-run the tool in the Find mode, the results from the previous Find operation for a job will be discarded, and the tool will re-scan the specified locations.</span></span> 

<span data-ttu-id="3a592-220">若要阻止对 PST 文件的访问：</span><span class="sxs-lookup"><span data-stu-id="3a592-220">To block access to PST files:</span></span>

1. <span data-ttu-id="3a592-221">在本地计算机上打开命令提示符 （以管理员身份运行）。</span><span class="sxs-lookup"><span data-stu-id="3a592-221">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="3a592-222">转到下载 PST 集合工具的目录。</span><span class="sxs-lookup"><span data-stu-id="3a592-222">Go to the directory where you downloaded the PST Collection tool to.</span></span>
    
3. <span data-ttu-id="3a592-223">运行以下命令以阻止对在步骤 1 中找到的 PST 文件的访问。</span><span class="sxs-lookup"><span data-stu-id="3a592-223">Run the following command to block access to the PST files found in Step 1.</span></span>

    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Block -JobName <Name of job from Step 1> -ConfigurationLocation <Location of configuration files from Step 1> -BlockChangesToFiles -BlockNewFiles
    ```

    <span data-ttu-id="3a592-224">下表介绍参数以及它们所需的值，当您运行 DataCollectorMaster.exe 命令，以阻止创建和更改的 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-224">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to block the creation and changing of PST files.</span></span> 
    
    |<span data-ttu-id="3a592-225">参数 \*\*\*</span><span class="sxs-lookup"><span data-stu-id="3a592-225">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="3a592-226">\*\*\*\*Description\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="3a592-226">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="3a592-227">示例 \*\*\*</span><span class="sxs-lookup"><span data-stu-id="3a592-227">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="3a592-p130">指定要搜索数据的类型。目前，您可以使用 PST 收集工具搜索 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p130">Specifies the type of data to search for. Currently, you can use the PST Collection tool to search for PST files.</span></span>  <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="3a592-p131">指定该工具将执行的操作的类型。使用值`Block`阻止用户创建新的 PST 文件并对现有 PST 文件进行更改。</span><span class="sxs-lookup"><span data-stu-id="3a592-p131">Specifies the type of operation that the tool will perform. Use the value  `Block` to prevent users from creating new PST files and making changes to existing PST files.  </span></span><br/> | `-Mode Block` <br/> |
    | `JobName` <br/> |<span data-ttu-id="3a592-p132">指定现有的 PST 集合作业的名称。您必须使用此作业的名称相同时在步骤 1 中的查找模式下运行该工具使用。此作业名称添加到阻止模式中运行该工具时，将创建日志文件的名称。</span><span class="sxs-lookup"><span data-stu-id="3a592-p132">Specifies the name of an existing PST Collection job. You have to use this same job name that you used when you ran the tool in the Find mode in Step 1. This job name is also added to the name of the log file that is created when you run the tool in the Block mode.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="3a592-p133">指定文件夹中包含.xml 配置文件中查找模式运行工具时创建的。使用用于在步骤 1 中此参数的值相同。</span><span class="sxs-lookup"><span data-stu-id="3a592-p133">Specifies the folder contains the .xml configuration file that was created when you ran the tool in the Find mode. Use the same value that you used for this parameter in Step 1.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration"` <br/> |
    | `LogLocation` <br/> |<span data-ttu-id="3a592-p134">指定阻止操作的日志文件将被复制到的文件夹。这是一个可选参数。如果不包括它，日志文件复制到其中下载 PST 集合工具的文件夹。请考虑使用您在步骤 1 中的查找模式下运行该工具时，以便所有日志文件将都保存在同一文件夹时所使用的日志位置相同。</span><span class="sxs-lookup"><span data-stu-id="3a592-p134">Specifies the folder that the log file for the Block operation will be copied to. This is an optional parameter. If you don't include it, the log file is copied to the folder where you downloaded the PST Collection tool to. Consider using the same log location that you used when you ran the tool in the Find mode in Step 1 so that all the log files are saved in the same folder.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `BlockChangesToFiles` <br/> |<span data-ttu-id="3a592-p135">使用此开关，以防止用户更改 PST 文件。当您使用此开关时，创建以下注册表项： `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\PST\PstDisableGrow` ，数据值设置为 1。此注册表设置阻止模式中运行 PST 集合工具时创建的 GPO 创建您的组织中的计算机上。</span><span class="sxs-lookup"><span data-stu-id="3a592-p135">Use this switch to prevent users from changing a PST file. When you use this switch, the following registry entry is created:  `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\PST\PstDisableGrow` and the data value is set to 1. This registry setting is created on the machines in your organization by the GPO that's created when you run the PST Collection tool in the Block mode.  </span></span><br/> | `-BlockChangesToFiles` <br/> |
    | `BlockNewFiles` <br/> |<span data-ttu-id="3a592-p136">使用此开关来阻止用户创建新的 PST 文件、 打开和将 PST 文件导入到 Outlook，和从 Outlook 导出 PST 文件。当您使用此开关时，创建以下注册表项： `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\DisablePst` ，数据值设置为 1。此注册表设置阻止模式中运行 PST 集合工具时创建的 GPO 创建您的组织中的计算机上。</span><span class="sxs-lookup"><span data-stu-id="3a592-p136">Use this switch to prevent users from creating new PST files, opening and importing PST files to Outlook, and exporting PST files from Outlook. When you use this switch, the following registry entry is created:  `HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\<version>\Outlook\DisablePst` and the data value is set to 1. This registry setting is created on the machines in your organization by the GPO that's created when you run the PST Collection tool in the Block mode.  </span></span><br/> | `-BlockNewFiles` <br/> |
   
    <span data-ttu-id="3a592-247">下面是语法的使用实际值的每个参数 DataCollectorMaster.exe 命令示例：</span><span class="sxs-lookup"><span data-stu-id="3a592-247">Here's an example of the syntax for the DataCollectorMaster.exe command using actual values for each parameter:</span></span>

    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Block -JobName PstSearch1 -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration" -LogLocation "c:\users\admin\desktop\PSTCollection" -BlockChangesToFiles -BlockNewFiles
    ```
    
    <span data-ttu-id="3a592-p137">系统会提示您确认要阻止新的 PST 文件或更改现有 PST 文件。您确认要继续并成功运行该命令后，将显示一条消息，告知已创建一个新的 GPO，名为"PST 使用率控件"。</span><span class="sxs-lookup"><span data-stu-id="3a592-p137">You are prompted to confirm that you want to block new PST files or changes to existing PST files. After you confirm that you want to continue and the command successfully runs, a message is displayed saying that a new GPO, named "PST Usage Controls", has been created.</span></span>
    
## <a name="step-3-copy-the-pst-files-to-a-collection-location"></a><span data-ttu-id="3a592-250">步骤 3： 将 PST 文件复制到集合的位置</span><span class="sxs-lookup"><span data-stu-id="3a592-250">Step 3: Copy the PST files to a collection location</span></span>

<span data-ttu-id="3a592-p138">下一步是复制 PST 文件的在其中找到时则查找模式中运行 PST 集合工具。这样可以收集在一个位置的 PST 文件，以便您可以稍后将其导入 Office 365。PST 文件复制到集合位置之前，请考虑确定的总所需的存储空间量。您可以执行此操作使用来计算所有 PST 文件的总大小的步骤 1 中创建的 CSV 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p138">The next step is to copy the PST files that where found when you ran the PST Collection tool in the Find mode. This lets you collect the PST files in one location so that you can later import them to Office 365. Before you copy the PST files to collection location, consider determining the total amount of storage space that is required. You can do this using the CSV file that was created in Step 1 to calculate the total size of all PST files.</span></span>
  
> [!NOTE]
> <span data-ttu-id="3a592-255">已导入到 Office 365 的 PST 文件，并已将其删除从其原始位置后，您可能想要从您在此步骤中复制到这些集合位置将其删除。</span><span class="sxs-lookup"><span data-stu-id="3a592-255">After you've imported the PST files to Office 365 and deleted them from their original location, you might want to delete them from the collection location that you copied them to in this step.</span></span> 
  
1. <span data-ttu-id="3a592-256">在本地计算机上打开命令提示符 （以管理员身份运行）。</span><span class="sxs-lookup"><span data-stu-id="3a592-256">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="3a592-257">转到下载 PST 集合工具的目录。</span><span class="sxs-lookup"><span data-stu-id="3a592-257">Go to the directory where you downloaded the PST Collection tool to.</span></span>
    
3. <span data-ttu-id="3a592-258">运行以下命令以将 PST 文件复制到指定的位置。</span><span class="sxs-lookup"><span data-stu-id="3a592-258">Run the following command to copy the PST files to a specified location.</span></span>
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Collect -JobName <Name of job from Step 1> -Locations <same locations from Step 1> -ConfigurationLocation <Location of configuration files from Step 1> -CopyLocation <Location to copy PST files to>
    ```

    <span data-ttu-id="3a592-259">下表介绍参数和其所需的值，当您运行 DataCollectorMaster.exe 命令复制 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-259">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to copy PST files.</span></span> 
    
    |<span data-ttu-id="3a592-260">参数 \*\*\*</span><span class="sxs-lookup"><span data-stu-id="3a592-260">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="3a592-261">\*\*\*\*Description\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="3a592-261">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="3a592-262">示例 \*\*\*</span><span class="sxs-lookup"><span data-stu-id="3a592-262">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="3a592-p139">指定要搜索数据的类型。目前，您可以使用 PST 收集工具搜索 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p139">Specifies the type of data to search for. Currently, you can use the PST Collection tool to search for PST files.</span></span>  <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="3a592-p140">指定该工具将执行的操作的类型。使用值`Collect`复制 PST 文件的找到您何时运行查找模式中的工具。请注意，此工具可以复制 PST 文件在 Outlook 中打开并将连接到 Outlook 配置文件的 PST 文件复制。</span><span class="sxs-lookup"><span data-stu-id="3a592-p140">Specifies the type of operation that the tool will perform. Use the value  `Collect` to copy that PST files that were found when you ran to the tool in the Find mode. Note that the tool is able copy PST files that are open in Outlook and copy PST files that are connected to Outlook profiles.  </span></span><br/> | `-Mode Collect` <br/> |
    | `JobName` <br/> |<span data-ttu-id="3a592-p141">指定现有的 PST 集合作业的名称。您必须使用此作业的名称相同时在步骤 1 中的查找模式下运行该工具使用。此作业名称添加到在收集模式下运行该工具时，将创建日志文件的名称。</span><span class="sxs-lookup"><span data-stu-id="3a592-p141">Specifies the name of an existing PST Collection job. You have to use this same job name that you used when you ran the tool in the Find mode in Step 1. This job name is also added to the name of the log file that is created when you run the tool in the Collect mode.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `Locations` <br/> |<span data-ttu-id="3a592-p142">使用相同的值用于`Locations`在步骤 1 中的参数。如果您想要重新运行该工具，从源位置在步骤 5 中删除 PST 文件以收集模式运行该工具时，您已包括此参数。</span><span class="sxs-lookup"><span data-stu-id="3a592-p142">Use the same value that you used for the  `Locations` parameter in Step 1. You have include this parameter when you run the tool in the Collect mode if you want to re-run the tool to delete the PST files from their source location in Step 5.  </span></span><br/> | `-Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com"; "CN=FILESERVER02,CN=Computers,DC=contoso,DC=com"` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="3a592-p143">指定包含.xml 配置文件中查找模式运行工具时创建的文件夹。使用用于在步骤 1 中此参数的值相同。</span><span class="sxs-lookup"><span data-stu-id="3a592-p143">Specifies the folder that contains the .xml configuration file that was created when you ran the tool in the Find mode. Use the same value that you used for this parameter in Step 1.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\desktop \PSTCollection\Configuration"` <br/> |
    | `CopyLocation` <br/> |<span data-ttu-id="3a592-p144">指定要从中复制到 PST 文件的集合位置。您可以将文件复制到文件服务器、 网络文件共享或硬盘驱动器。在收集模式下运行该工具之前必须存在的位置。该工具不会创建位置，并将返回的错误消息不存在。</span><span class="sxs-lookup"><span data-stu-id="3a592-p144">Specifies the collection location where you want to copy the PST files to. You can copy files to a file server, a network file share, or a hard drive. The location must exist before you run the tool in the Collect mode. The tool doesn't create the location, and will return an error saying that it doesn't exist.</span></span>  <br/> <span data-ttu-id="3a592-279">此外，您需要此参数所指定的集合位置的写入权限。</span><span class="sxs-lookup"><span data-stu-id="3a592-279">Also, you have to write permissions to the collection location specified by this parameter.</span></span>  <br/> | `-CopyLocation "\\FILESERVER03\PSTs"` <br/> |
    | `LogLocation` <br/> |<span data-ttu-id="3a592-p145">指定收集模式的日志文件将被复制到的文件夹。这是一个可选参数。如果不包括它，日志文件复制到其中下载 PST 集合工具的文件夹。请考虑使用您在步骤 1 中的查找模式下运行该工具时，以便所有日志文件将都保存在同一文件夹时所使用的日志位置相同。</span><span class="sxs-lookup"><span data-stu-id="3a592-p145">Specifies the folder that the log file for the Collect mode will be copied to. This is an optional parameter. If you don't include it, the log file is copied to the folder where you downloaded the PST Collection tool to. Consider using the same log location that you used when you ran the tool in the Find mode in Step 1 so that all the log files are saved in the same folder.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `ForceRestart` <br/> |<span data-ttu-id="3a592-p146">此可选开关，可以重新在现有 PST 集合作业集合模式下运行该工具。如果您之前在收集模式中，运行该工具，但然后在使用查找模式下再次运行该工具`ForceRestart`切换重新扫描 PST 文件的位置，您可以使用此开关重新在集模式运行该工具并没有找到时的 PST 文件重新复制您重新扫描的位置。当使用`ForceRestart`集模式，该工具中的开关将忽略所有以前回收操作并尝试从零开始复制 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p146">This optional switch lets you re-run the tool in the Collection mode for an existing PST Collection job. If you previously ran the tool in the Collect mode, but then ran the tool again in the Find mode with the  `ForceRestart` switch to re-scan locations for PST files, you can use this switch to re-run the tool in Collection mode and re-copy the PST files there were found when your re-scanned the locations. When using the  `ForceRestart` switch in Collection mode, the tool ignores any previous Collection operations and attempts to copy the PST files from scratch.  </span></span><br/> | `-ForceRestart` <br/> |
   
    <span data-ttu-id="3a592-287">下面是一个示例使用的每个参数的实际值的 DataCollectorMaster.exe 工具的语法：</span><span class="sxs-lookup"><span data-stu-id="3a592-287">Here's an example of the syntax for the DataCollectorMaster.exe tool using actual values for each parameter:</span></span>
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Collect -JobName PstSearch1 -Locations "CN=FILESERVER01,CN=Computers,DC=contoso,DC=com";"CN=FILESERVER02,CN=Computers,DC=contoso,DC=com" -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration" -CopyLocation "\\FILESERVER03\PSTs" -LogLocation "c:\users\admin\desktop\PSTCollection"
    ```

    <span data-ttu-id="3a592-p147">运行该命令后，则显示显示进度收集在步骤 1 中找到的 PST 文件的详细的状态消息。后一段时间，最终状态消息显示是否存在任何错误和日志复制到的位置。相同的状态邮件复制到.log 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p147">After you run the command, detailed status messages are displayed that show the progress of collecting the PST files that were found in Step 1. After a while, a final status message shows if there were any errors and the location that the log is copied to. The same status messages are copied to the .log file.</span></span>
    
### <a name="results-of-running-datacollectormasterexe-in-the-collect-mode"></a><span data-ttu-id="3a592-291">在收集模式下运行 DataCollectorMaster.exe 的结果</span><span class="sxs-lookup"><span data-stu-id="3a592-291">Results of running DataCollectorMaster.exe in the Collect mode</span></span>

<span data-ttu-id="3a592-292">成功收集模式中运行 DataCollectorMaster.exe 后，创建并通过指定的文件夹中存储以下文件`LogLocation`和`ConfigurationLocation`参数。</span><span class="sxs-lookup"><span data-stu-id="3a592-292">After you successfully run DataCollectorMaster.exe in the Collect mode, the following files are created and stored in the folders specified by the  `LogLocation` and  `ConfigurationLocation` parameters.</span></span> 
  
- <span data-ttu-id="3a592-p148">**\<JobName\>_收集_\<DateTimeStamp\>.log** -日志文件中包含已显示状态消息。在指定的文件夹中创建此文件`LogLocation`参数。</span><span class="sxs-lookup"><span data-stu-id="3a592-p148">**\<JobName\>_Collect_\<DateTimeStamp\>.log** - The log file contains the status messages that were displayed. This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
- <span data-ttu-id="3a592-p149">**\<JobName\>_收集_\<DateTimeStamp\>.xml** -XML 文件仅包含其中使用该工具已收集模式中运行信息参数值。运行时使用此文件中的数据重新运行 DataCollectorMaster.exe 工具删除 PST 文件;请参阅[第 5 步](#step-5-delete-the-pst-files-found-on-your-network)。</span><span class="sxs-lookup"><span data-stu-id="3a592-p149">**\<JobName\>_Collect_\<DateTimeStamp\>.xml** - The XML file only contains information about the parameter values that where used by the tool was run in the Collect mode. The data in this file is used when you run re-run the DataCollectorMaster.exe tool to delete PST files; see [Step 5](#step-5-delete-the-pst-files-found-on-your-network).</span></span>
    

## <a name="step-4-import-the-pst-files-to-office-365"></a><span data-ttu-id="3a592-297">步骤 4： 将 PST 文件导入到 Office 365</span><span class="sxs-lookup"><span data-stu-id="3a592-297">Step 4: Import the PST files to Office 365</span></span>

<span data-ttu-id="3a592-p150">您已收集在步骤 1 中找到的 PST 文件后下, 一步是将其导入 Office 365 中的邮箱。为部件或导入过程中，您将需要创建 CSV 映射文件包含要导入每个 PST 文件中的行。每行中的信息指定 PST 文件，该用户的电子邮件地址的名称，并且您是否要将 PST 文件导入用户的主要或存档邮箱。使用中的信息**JobName\>_查找_\<DateTimeStamp.csv**文件 （在步骤中创建） 可帮助您创建 CSV 映射文件的 1。</span><span class="sxs-lookup"><span data-stu-id="3a592-p150">After you've collected the PST files found in Step 1, the next step is to import them to mailboxes in Office 365. As part or the import process, you'll have to create a CSV mapping file that contains a row of each PST file that you want import. Information in each row specifies the name of the PST file, the user's email address, and whether you want to import the PST file to the user's primary or archive mailbox. Use the information in the **JobName\>_Find_\<DateTimeStamp.csv** file (created in Step) 1 to help you create the CSV mapping file.</span></span> 
  
<span data-ttu-id="3a592-302">到 Office 365 导入 PST 文件的分步说明，请参阅以下主题之一：</span><span class="sxs-lookup"><span data-stu-id="3a592-302">For step-by-step instructions to import PST files to Office 365, see one of the following topics:</span></span>
  
- [<span data-ttu-id="3a592-303">使用网络上载将 PST 文件导入到 Office 365</span><span class="sxs-lookup"><span data-stu-id="3a592-303">Use network upload to import PST files to Office 365</span></span>](use-network-upload-to-import-pst-files.md)
    
- [<span data-ttu-id="3a592-304">使用驱动器寄送，将 PST 文件导入到 Office 365</span><span class="sxs-lookup"><span data-stu-id="3a592-304">Use drive shipping to import PST files to Office 365</span></span>](use-drive-shipping-to-import-pst-files-to-office-365.md)
    

## <a name="step-5-delete-the-pst-files-found-on-your-network"></a><span data-ttu-id="3a592-305">步骤 5： 删除您的网络上找到的 PST 文件</span><span class="sxs-lookup"><span data-stu-id="3a592-305">Step 5: Delete the PST files found on your network</span></span>

<span data-ttu-id="3a592-306">找到并收集的 PST 文件导入到 Office 365 中的 Exchange Online 邮箱后，您可以使用 PST 收集工具可从其中已找到步骤 1 中的原始源位置删除 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-306">After the PST files that you found and collected have been imported to Exchange Online mailboxes in Office 365, you can use the PST Collection tool to delete the PST files from the original source locations where they were found in Step 1.</span></span> 
  
1. <span data-ttu-id="3a592-307">在本地计算机上打开命令提示符 （以管理员身份运行）。</span><span class="sxs-lookup"><span data-stu-id="3a592-307">Open a Command Prompt (run as administrator) on your local computer.</span></span>
    
2. <span data-ttu-id="3a592-308">转到下载 PST 集合工具的目录。</span><span class="sxs-lookup"><span data-stu-id="3a592-308">Go to the directory where you downloaded the PST Collection tool to.</span></span>
    
3. <span data-ttu-id="3a592-309">运行以下命令以删除 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-309">Run the following command to delete the PST files.</span></span>

    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Delete -JobName <Name of job from Step 1> -ConfigurationLocation <Location of configuration files from Step 1> -CopyLocation <Location to copy PST files to>
    ```

    <span data-ttu-id="3a592-310">下表介绍参数以及它们所需的值时运行 DataCollectorMaster.exe 命令以删除 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-310">The following table describes the parameters and their required values when you run the DataCollectorMaster.exe command to delete PST files.</span></span> 
    
    |<span data-ttu-id="3a592-311">参数 \*\*\*</span><span class="sxs-lookup"><span data-stu-id="3a592-311">\*\*\*\*Parameter\*\*\*\*</span></span>|<span data-ttu-id="3a592-312">\*\*\*\*Description\*\*\*\*</span><span class="sxs-lookup"><span data-stu-id="3a592-312">\*\*\*\*Description\*\*\*\*</span></span>|<span data-ttu-id="3a592-313">示例 \*\*\*</span><span class="sxs-lookup"><span data-stu-id="3a592-313">\*\*\*\*Examples\*\*\*\*</span></span>|
    |:-----|:-----|:-----|
    | `DataSource` <br/> |<span data-ttu-id="3a592-p151">指定要搜索数据的类型。目前，您可以使用 PST 收集工具搜索 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p151">Specifies the type of data to search for. Currently, you can use the PST Collection tool to search for PST files.</span></span> ![分隔](media/b078d05c-3aee-4b9f-8805-6a8a9d8970ee.png)           <br/> | `-DataSource Pst` <br/> |
    | `Mode` <br/> |<span data-ttu-id="3a592-p152">指定该工具将执行的操作的类型。使用值`Delete`删除 PST 文件的找到您何时运行查找模式中的工具。</span><span class="sxs-lookup"><span data-stu-id="3a592-p152">Specifies the type of operation that the tool will perform. Use the value  `Delete` to delete that PST files that were found when you ran to the tool in the Find mode.  </span></span><br/> | `-Mode Delete` <br/> |
    | `JobName` <br/> |<span data-ttu-id="3a592-p153">指定现有的 PST 集合作业的名称。您必须使用此作业的名称相同查找模式和步骤 1 和步骤 3 中的收集模式中运行该工具时使用。此作业名称添加到您在删除模式下运行该工具时，将创建日志文件的名称。</span><span class="sxs-lookup"><span data-stu-id="3a592-p153">Specifies the name of an existing PST Collection job. You have to use this same job name that you used when you ran the tool in the Find mode and the Collect mode in Step 1 and Step 3. This job name is also added to the name of the log file that is created when you run the tool in the Delete mode.</span></span>  <br/> | `-JobName PstSearch1` <br/> |
    | `ConfigurationLocation` <br/> |<span data-ttu-id="3a592-p154">指定包含.xml 配置文件时收集模式中运行该工具创建的文件夹。使用相同的值用于此步骤 3 中的参数。</span><span class="sxs-lookup"><span data-stu-id="3a592-p154">Specifies the folder that contains the .xml configuration file that was created when you ran the tool in the Collect mode. Use the same value that you used for this parameter in Step 3.</span></span>  <br/> | `-ConfigurationLocation "c:\users\admin\ desktop\PSTCollection\Configuration"` <br/> |
    | `LogLocation` <br/> |<span data-ttu-id="3a592-p155">指定删除模式的日志文件将被复制到的文件夹。这是一个可选参数。如果不包括它，日志文件复制到其中下载 PST 集合工具的文件夹。请考虑使用，以便所有日志文件将都保存在同一文件夹中查找和步骤 1 和步骤 3 中的收集模式运行该工具时所使用的日志位置相同。</span><span class="sxs-lookup"><span data-stu-id="3a592-p155">Specifies the folder that the log file for the Delete mode will be copied to. This is an optional parameter. If you don't include it, the log file is copied to the folder where you downloaded the PST Collection tool to. Consider using the same log location that you used when you ran the tool in the Find and Collect modes in Step 1 and Step 3 so that all the log files are saved in the same folder.</span></span>  <br/> | `-LogLocation "c:\users\admin\desktop\PSTCollection"` <br/> |
    | `ForceRestart` <br/> |<span data-ttu-id="3a592-p156">此可选开关，可以重新在现有 PST 集合作业的删除模式运行该工具。如果您之前在删除模式中，运行该工具，但然后在使用查找模式下再次运行该工具`ForceRestart`切换重新扫描 PST 文件的位置，您可以使用此开关重新在删除模式下运行该工具并删除 PST 文件没有找到时您 re scanned 位置。当使用`ForceRestart`中删除模式，该工具的开关忽略任何以前的删除操作，尝试再次删除 PST 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p156">This optional switch lets you re-run the tool in the Delete mode for an existing PST Collection job. If you previously ran the tool in the Delete mode, but then ran the tool again in the Find mode with the  `ForceRestart` switch to re-scan locations for PST files, you can use this switch to re-run the tool in Delete mode and delete the PST files there were found when your re-scanned the locations. When using the  `ForceRestart` switch in Delete mode, the tool ignores any previous Delete operations and attempts to delete the PST files again.  </span></span><br/> | `-ForceRestart` <br/> 

    <span data-ttu-id="3a592-331">下面是一个示例使用的每个参数的实际值的 DataCollectorMaster.exe 工具的语法：</span><span class="sxs-lookup"><span data-stu-id="3a592-331">Here's an example of the syntax for the DataCollectorMaster.exe tool using actual values for each parameter:</span></span>
    
    ```
    DataCollectorMaster.exe -DataSource Pst -Mode Delete -JobName PstSearch1 -ConfigurationLocation "c:\users\admin\desktop\PSTCollection\Configuration" -LogLocation "c:\users\admin\desktop\PSTCollection"
    ```
   
    <span data-ttu-id="3a592-p157">运行该命令后，则显示显示进度删除在步骤 1 中找到，在步骤 3 中收集的 PST 文件的详细的状态消息。后一段时间，最终状态消息显示是否存在任何错误和日志复制到的位置。相同的状态邮件复制到.log 文件。</span><span class="sxs-lookup"><span data-stu-id="3a592-p157">After you run the command, detailed status messages are displayed that show the progress of deleting the PST files that were found in Step 1 and collected in Step 3. After a while, a final status message shows if there were any errors and the location that the log is copied to. The same status messages are copied to the .log file.</span></span>
    
### <a name="results-of-running-datacollectormasterexe-in-the-delete-mode"></a><span data-ttu-id="3a592-335">在删除模式下运行 DataCollectorMaster.exe 的结果</span><span class="sxs-lookup"><span data-stu-id="3a592-335">Results of running DataCollectorMaster.exe in the Delete mode</span></span>

<span data-ttu-id="3a592-336">成功删除模式中运行 DataCollectorMaster.exe 后，创建并在指定的文件夹中存储以下文件`LogLocation`和`ConfigurationLocation`参数。</span><span class="sxs-lookup"><span data-stu-id="3a592-336">After you successfully run DataCollectorMaster.exe in the Delete mode, the following files are created and stored in the folder specified by the  `LogLocation` and  `ConfigurationLocation` parameters.</span></span> 
  
- <span data-ttu-id="3a592-p158">**\<JobName\>_删除_\<DateTimeStamp\>.log** -日志文件中包含已显示状态消息。在指定的文件夹中创建此文件`LogLocation`参数。</span><span class="sxs-lookup"><span data-stu-id="3a592-p158">**\<JobName\>_Delete_\<DateTimeStamp\>.log** - The log file contains the status messages that were displayed. This file is created in the folder specified by the  `LogLocation` parameter.</span></span> 
    
- <span data-ttu-id="3a592-p159">**\<JobName\>_删除_\<DateTimeStamp\>.xml** -XML 文件仅包含其中使用该工具已删除模式中运行信息参数值。它还列出了每个已删除的 PST 文件的名称和文件路径。在指定的文件夹中创建此文件`ConfigurationLocation`参数。</span><span class="sxs-lookup"><span data-stu-id="3a592-p159">**\<JobName\>_Delete_\<DateTimeStamp\>.xml** - The XML file only contains information about the parameter values that where used by the tool was run in the Delete mode. It also lists the name and file path of each PST file that was deleted. This file is created in the folder specified by the  `ConfigurationLocation` parameter.</span></span> 
